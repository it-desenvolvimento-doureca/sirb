<!--div class="col-md-12  hidden-xs">
  <div class="card-header" data-background-color="orange">
    <div class="nav-tabs-navigation">
      <div class="nav-tabs-wrapper">
        <ul class="nav nav-tabs" style="background:black">
          <li [hidden]="!btvoltar">
            <a (click)=" backClicked()">
              <i class="material-icons">arrow_back</i>Voltar
              <div class="ripple-container"></div>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div-->
<div class="main-content dashboard_css"
  style="display: inline;padding: 0; display: block; height: calc(100% - 145px); background: none;"
  id="main_dashboard_css">
  <div class="container-fluid" style="height: 100%;">
    <div class="row" style="height: 100%;">
      <div class="col-md-12" style="height: 100%;">
        <div class="card" style="height: 100%; background: none; margin-top: 1px;">

          <div class="card-content" style="height: 100%; padding: 0;">
            <p-tabView orientation="bottom">
              <p-tabPanel header="Geral">

                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                    <div class="col-md-3">
                      <div class="mini-stat clearfix">
                        <span class="mini-stat-icon green"><i style="font-size: 60px;" class="fa fa-smile-o"></i></span>
                        <div class="mini-stat-info">
                          <span>0</span>
                          Acidentes de Trabalho
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">

                    </div>
                    <div class="col-md-3">

                    </div>
                    <div class="col-md-3">

                    </div>
                  </div>
                  <!--mini statistics end-->
                  <div class="row" style="display: initial;">
                    <div class="col-md-12">
                      <!--notification start-->
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h">Visitas</h4>
                        </header>
                        <div class="panel-body">
                          <div class="alert alert-info clearfix" *ngFor="let visita of visitas ">
                            <span class="alert-icon"><i class="fa fa-envelope-o"></i></span>
                            <div class="notification-info">
                              <ul class="clearfix notification-meta">
                                <li class="pull-left notification-sender"><span><a>{{visita.VISITA}}</a></span> </li>
                                <li class="pull-right notification-time">{{visita.DATA_INI}} - {{visita.DATA_FIM}}</li>
                              </ul>
                              <!--p>
                                Urgent meeting for next proposal
                              </p-->
                            </div>
                          </div>

                          <div class="alert alert-info clearfix" *ngIf="visitas.length == 0">
                            <div class="notification-info">
                              <p>
                                Sem Dados
                              </p>
                            </div>
                          </div>

                        </div>
                      </section>
                      <!--notification end-->
                    </div>

                  </div>

                </section>
              </p-tabPanel>
              <p-tabPanel header="Recursos Humanos">
                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                    <div class="col-md-3">
                      <div class="mini-stat clearfix">
                        <span class="mini-stat-icon orange"><i class="fa fa-users"></i></span>
                        <div class="mini-stat-info">
                          <span>{{funcionarios_ativos}}</span>
                          Funcionários Ativos
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="mini-stat clearfix">
                        <span class="mini-stat-icon tar"><i class="fa fa-users"></i></span>
                        <div class="mini-stat-info">
                          <span>{{funcionarios_saobento}}</span>
                          Funcionários Ativos São Bento
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="mini-stat clearfix">
                        <span class="mini-stat-icon pink"><i class="fa fa-users"></i></span>
                        <div class="mini-stat-info">
                          <span>{{funcionarios_formariz}}</span>
                          Funcionários Ativos Formariz
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="mini-stat clearfix">
                        <span class="mini-stat-icon green"><i class="fa fa-users"></i></span>
                        <div class="mini-stat-info">
                          <span>{{funcionarios_faltar}}</span>
                          Funcionários a Faltar
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--mini statistics end-->

                  <div class="row" style="display: initial;">

                    <div class="col-md-6">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h">Funcionários Ativos por Departamento</h4>
                        </header>
                        <div class="panel-body">
                          <div class="top-stats-panel">
                            <div class="bar-stats">
                              <ul class="progress-stat-bar clearfix">
                                <li *ngFor="let depart of departamentos " [escape]="false"
                                  style="padding-top: 40px; justify-content: center; align-items: center; display: flex;"
                                  pTooltip="<span class='bar-legend-pointer {{depart.cor}}'></span> <b> {{depart.descricao}} : </b> {{depart.total}}"
                                  tooltipStyleClass="tooltip_barras" tooltipPosition="top">
                                  <span
                                    style="padding: 2px; font-weight: 600; height: 22px; width: 20px; text-align: center; box-shadow: 0 0px 2px 0px #444141; position: absolute; z-index: 9;">{{depart.total}}</span>
                                  <span class="progress-stat-percent {{depart.cor}}"
                                    [style.height]="depart.percentagem+'%'">
                                  </span>
                                </li>

                              </ul>
                              <ul class="bar-legend">
                                <li *ngFor="let depart of departamentos "><span
                                    class="bar-legend-pointer {{depart.cor}}"></span> {{depart.descricao}}</li>
                              </ul>
                              <!--div class="daily-sales-info">
                                <span class="sales-count">1200 </span> <span class="sales-label">Total</span>
                              </div-->
                            </div>
                          </div>
                        </div>
                      </section>
                    </div>
                    <div class="col-sm-6">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Absentismo</h4>
                        </header>
                        <div class="panel-body">
                          <table id="tabela_absentismo" style="height: 99%;"
                            class=" table table-head-bg-primary table-bordered table-striped table-hover">
                            <thead>
                              <tr>
                                <th scope="col">Local</th>
                                <th scope="col" colspan="2" style="text-align: center">Taxa Absentismo <br>
                                  ({{dia_absentismo}})</th>
                                <th scope="col" style="text-align: center">Taxa Absentismo <br>
                                  ({{mes_absentismo}})</th>
                                <th scope="col" style="text-align: center">Taxa Absentismo <br>
                                  ({{ano_absentismo}})</th>
                              </tr>
                              <tr>
                                <th scope="col">Setor</th>
                                <th scope="col" style="text-align: center"><span
                                    title="P = Presentes/Trabalharam  |   T = Total Operários">P | T</span></th>
                                <th scope="col" style="text-align: center"> % </th>
                                <th scope="col" style="text-align: center"> % </th>
                                <th scope="col" style="text-align: center"> % </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let local of locais ">
                                <td>{{local.local}}</td>
                                <td style="text-align: center;">{{local.operarios_trabalhar}}/{{local.operarios_total}}
                                </td>
                                <td style="text-align: center;">{{local.valor_dia |number : '1.2-2'}}</td>
                                <td style="text-align: center;">{{local.valor_mes |number : '1.2-2'}}</td>
                                <td style="text-align: center;">{{local.valor_ano |number : '1.2-2'}}</td>
                              </tr>
                              <tr *ngIf="locais.length == 0">
                                <td colspan="5" style="text-align: center;">Sem Dados</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </section>
                    </div>
                  </div>


                </section>
              </p-tabPanel>

              <p-tabPanel header="Produção">
                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                    <div class="col-sm-12">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Índice de Cuprimento do Plano</h4>
                        </header>
                        <div class="panel-body">
                          <table class="table  table-bordered table-striped table-hover tg" id="tg1">
                            <thead>
                              <tr>
                                <th rowspan="3" class="tg-0pky">Data</th>
                                <th class="tg-wfll" colspan="6">% Cumprimento do Plano</th>
                                <th class="tg-wfll" colspan="6">% Ocupação da Linha</th>
                                <th class="tg-wfll" colspan="6">% Ocupação Total da Linha </th>
                              </tr>
                              <tr>
                                <th class="tg-gy6f" colspan="3">L1</th>
                                <th class="tg-gy6f" colspan="3">L2</th>
                                <th class="tg-gy6f" colspan="3">L1</th>
                                <th class="tg-gy6f" colspan="3">L2</th>
                                <th class="tg-gy6f" colspan="3">L1</th>
                                <th class="tg-gy6f" colspan="3">L2</th>
                              </tr>
                              <tr>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                                <th class="tg-gy6f">Turno 1</th>
                                <th class="tg-gy6f">Turno 2</th>
                                <th class="tg-gy6f">Turno 3</th>
                              </tr>
                            </thead>
                            <tr *ngFor="let col of dados_indice_comprimento">
                              <td class="tg-0pky"> {{col.DATA}} </td>

                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL1T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL1T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL1T3 |number : '1.2-2'}}</td>

                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL2T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL2T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.CUMP_PLANOL2T3 |number : '1.2-2'}}</td>

                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL1T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL1T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL1T3 |number : '1.2-2'}}</td>

                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL2T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL2T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_LINHAL2T3 |number : '1.2-2'}}</td>

                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL1T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL1T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL1T3 |number : '1.2-2'}}</td>

                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL2T1 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL2T2 |number : '1.2-2'}}</td>
                              <td class="tg-0pky">
                                {{col.OCUP_TOTALL2T3 |number : '1.2-2'}}</td>

                            </tr>
                            <tr *ngIf="dados_indice_comprimento.length == 0">
                              <td colspan="24" style="text-align: center;">Sem Dados</td>
                            </tr>
                          </table>
                        </div>
                      </section>
                    </div>
                    <div class="row" style="display: initial;">
                      <div class="col-sm-6">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> Barras Planeadas/Executadas (Semana x -1/2022)</h4>
                          </header>
                          <div class="panel-body analiseplanosestrategicos" style="height: 350px;">
                            <p-chart type="line" [data]="data_CumprimentoPlanos_semana1"
                              [options]="options_CumprimentoPlanos_semana1" height="350"> </p-chart>
                          </div>
                        </section>
                      </div>
                      <div class="col-sm-6">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> Barras Planeadas/Executadas (Semana x/2022)</h4>
                          </header>
                          <div class="panel-body analiseplanosestrategicos" style="height: 350px;">
                            <p-chart type="line" [data]="data_CumprimentoPlanos_semana2"
                              [options]="options_CumprimentoPlanos_semana2" height="350"> </p-chart>
                          </div>
                        </section>
                      </div>
                    </div>

                    <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                      <div class="col-sm-12">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> Amostras</h4>
                          </header>
                          <div class="panel-body">
                            <table class="table  table-bordered table-striped table-hover " id="tabelarejeicoes"
                              style="border: 1px solid #ddd;   ">
                              <thead>
                                <tr>
                                  <th scope="col" style="text-align: center;">Data Lanç.
                                  </th>
                                  <th scope="col" style="text-align: center;">Linha</th>
                                  <th scope="col" style="text-align: center;">Referência
                                  </th>
                                  <th scope="col" style="text-align: center;">Descrição
                                  </th>
                                  <th scope="col" style="text-align: center;">Tipo</th>
                                  <th scope="col" style="text-align: center;">Índice</th>
                                  <th scope="col" style="text-align: center;">Nº Barras
                                  </th>
                                  <th scope="col" style="text-align: center;">Ação</th>
                                  <th scope="col" style="text-align: center;">Responsável
                                  </th>
                                  <th scope="col" style="text-align: center;">Estado</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let amostra of amostras " style="border-top:1px grey solid;">
                                  <!--<td>{{amostra.data}}</td>-->
                                  <td>{{amostra.data_lacamento}}</td>
                                  <td  [style.background]="amostra.cor_linha">{{amostra.linha}}</td>
                                  <td>{{amostra.cod_ref}}</td>
                                  <td>{{amostra.descricao_ref}}</td>
                                  <td>{{amostra.tipo}}</td>
                                  <td>{{amostra.indice}}</td>
                                  <td>{{amostra.num_barras}}</td>
                                  <td style="padding: 0;">
                                    <table style="width: 100%;">
                                      <tr *ngFor="let accao of amostra.acao;let i=index; first as isFirst"
                                        [style.border-top]="isFirst ? 'none' : '1px #8080801a solid'"
                                        style="background: none;">
                                        <td style="border: none; padding-left: 15px;">
                                          {{accao}}
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                  <td style="padding: 0;">
                                    <table style="width: 100%;">
                                      <tr *ngFor="let responsavel of amostra.responsavel;let i=index; first as isFirst"
                                        [style.border-top]="isFirst ? 'none' : '1px #8080801a solid'"
                                        style="background: none;">
                                        <td style="border: none; padding-left: 15px;">
                                          {{responsavel}}
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                  <td [style.background]="amostra.cor_estado"
                                    [style.color]="(amostra.cor_estado != '')? 'white': '' ">{{amostra.estado}}</td>
                                </tr>
                                <tr *ngIf="amostras.length == 0">
                                  <td colspan="11" style="text-align: center;">Sem Dados</td>
                                </tr>
                              </tbody>
                            </table>

                          </div>
                        </section>
                      </div>

                    </div>
                  </div>
                </section>
              </p-tabPanel>

              <p-tabPanel header="Qualidade">
                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                    <div class="col-sm-12">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Análise de Rejeições</h4>
                        </header>
                        <div class="panel-body">
                          <table class="table  table-bordered table-striped table-hover " id="tabelarejeicoes"
                            style="border: 1px solid #ddd;  height: 155px;/*  */">
                            <thead>
                              <tr>
                                <th scope="col" rowspan="2" style="text-align: center; min-width: 197px;">
                                  Rejeições
                                  na Cromagem</th>
                                <th scope="col" rowspan="2" style="text-align: center;">
                                  Objetivos
                                </th>
                                <th scope="col" colspan="3" style="text-align: center;">
                                  {{data_formatada}}
                                </th>
                                <th scope="col" colspan="3" style="text-align: center;">
                                  {{mes}}
                                </th>
                                <th scope="col" colspan="3" style="text-align: center;">
                                  {{ano}}
                                </th>
                              </tr>
                              <tr style="border-bottom: 2px solid #ddd;">
                                <th scope="col" style="text-align: center; min-width: 50px;">L1</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">L2</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">Global</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">L1</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">L2</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">Global</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">L1</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">L2</th>
                                <th scope="col" style="text-align: center; min-width: 50px;">Global</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td style="border: 1px solid #ddd; text-align: left;">Rejeição Global</td>

                                <td style="">
                                  {{objetivo_rejeicao_global |number : '1.2-2'}}
                                </td>
                                <td [style.background]="(tipo0_linha1_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo0_linha1_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo0_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo0_linha2_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo0_linha2_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo0_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo0_linha33_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo0_linha33_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo0_linha33_area |number : '1.2-2'}}</td>

                                <td [style.background]="(tipo10_linha1_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo10_linha1_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo10_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo10_linha2_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo10_linha2_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo10_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo10_linha33_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo10_linha33_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo10_linha33_area |number : '1.2-2'}}</td>

                                <td [style.background]="(tipo20_linha1_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo20_linha1_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo20_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo20_linha2_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo20_linha2_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo20_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo20_linha33_area > objetivo_rejeicao_global )?'red':''"
                                  [style.color]="(tipo20_linha33_area > objetivo_rejeicao_global )?'white':''">
                                  {{tipo20_linha33_area |number : '1.2-2'}}</td>
                              </tr>

                              <tr>
                                <td style="border: 1px solid #ddd; text-align: left;">Rejeição Cromagem (< 10dm2)</td>
                                <td style="">
                                  {{objetivo_cromagem_menor |number : '1.2-2'}}
                                </td>
                                <td [style.background]="(tipo1_linha1_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo1_linha1_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo1_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo1_linha2_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo1_linha2_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo1_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo1_linha33_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo1_linha33_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo1_linha33_area |number : '1.2-2'}}</td>

                                <td [style.background]="(tipo11_linha1_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo11_linha1_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo11_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo11_linha2_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo11_linha2_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo11_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo11_linha33_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo11_linha33_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo11_linha33_area |number : '1.2-2'}}</td>

                                <td [style.background]="(tipo21_linha1_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo21_linha1_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo21_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo21_linha2_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo21_linha2_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo21_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo21_linha33_area > objetivo_cromagem_menor )?'red':''"
                                  [style.color]="(tipo21_linha33_area > objetivo_cromagem_menor )?'white':''">
                                  {{tipo21_linha33_area |number : '1.2-2'}}</td>
                              </tr>


                              <tr>
                                <td style="border: 1px solid #ddd; text-align: left;">Rejeição Cromagem (>=10dm2)</td>
                                <td style="">{{objetivo_cromagem_maior |number : '1.2-2'}}
                                </td>
                                <td [style.background]="(tipo2_linha1_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo2_linha1_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo2_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo2_linha2_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo2_linha2_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo2_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo2_linha33_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo2_linha33_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo2_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo12_linha1_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo12_linha1_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo12_linha1_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo12_linha2_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo12_linha2_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo12_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo12_linha33_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo12_linha33_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo12_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo22_linha1_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo22_linha1_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo22_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo22_linha2_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo22_linha2_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo22_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo22_linha33_area > objetivo_cromagem_maior )?'red':''"
                                  [style.color]="(tipo22_linha33_area > objetivo_cromagem_maior )?'white':''">
                                  {{tipo22_linha33_area |number : '1.2-2'}}</td>
                              </tr>


                              <tr>
                                <td style="border: 1px solid #ddd; text-align: left;">Rejeição Injeção (< 10dm2)</td>
                                <td style="">{{objetivo_injecao_menor |number : '1.2-2'}}
                                </td>
                                <td [style.background]="(tipo3_linha1_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo3_linha1_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo3_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo3_linha2_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo3_linha2_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo3_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo3_linha33_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo3_linha33_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo3_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo13_linha1_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo13_linha1_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo13_linha1_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo13_linha2_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo13_linha2_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo13_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo13_linha33_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo13_linha33_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo13_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo23_linha1_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo23_linha1_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo23_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo23_linha2_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo23_linha2_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo23_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo23_linha33_area > objetivo_injecao_menor )?'red':''"
                                  [style.color]="(tipo23_linha33_area > objetivo_injecao_menor )?'white':''">
                                  {{tipo23_linha33_area |number : '1.2-2'}}</td>
                              </tr>


                              <tr>
                                <td style="border: 1px solid #ddd; text-align: left;">Rejeição Injeção (>=10dm2)</td>
                                <td style="">{{objetivo_injecao_maior |number : '1.2-2'}}
                                </td>
                                <td [style.background]="(tipo4_linha1_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo4_linha1_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo4_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo4_linha2_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo4_linha2_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo4_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo4_linha33_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo4_linha33_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo4_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo14_linha1_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo14_linha1_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo14_linha1_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo14_linha2_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo14_linha2_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo14_linha2_area|number : '1.2-2'}}</td>
                                <td [style.background]="(tipo14_linha33_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo14_linha33_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo14_linha33_area|number : '1.2-2'}}</td>

                                <td [style.background]="(tipo24_linha1_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo24_linha1_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo24_linha1_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo24_linha2_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo24_linha2_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo24_linha2_area |number : '1.2-2'}}</td>
                                <td [style.background]="(tipo24_linha33_area > objetivo_injecao_maior )?'red':''"
                                  [style.color]="(tipo24_linha33_area > objetivo_injecao_maior )?'white':''">
                                  {{tipo24_linha33_area |number : '1.2-2'}}</td>
                              </tr>

                            </tbody>
                          </table>



                        </div>
                      </section>
                      <div class="col-sm-12" style="padding: 0;">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> % Rejeições Globais de Cromagem</h4>
                          </header>
                          <div class="panel-body">
                            <div class="analiseplanosestrategicos" style="height: 250px;">
                              <p-chart type="line" [data]="data_Rejeicoes" [options]="options_Rejeicoes" height="250">
                              </p-chart>
                            </div>
                          </div>
                        </section>

                      </div>
                      <div class="col-sm-12" style="padding: 0;">
                        <div class="panel-body" style="padding: 0;">
                          <div class="tabela_rej table-row table-header"
                            style=" background: #757676; color: white; font-weight: 500;">
                            <div class="table-row-column col-md-5" style="text-align: left;">
                              <!--button pButton icon="fa fa-search" style="height: 30px; width: 30px; top: 4px;" label=" "
                                class="ui-button-secondary" (click)="display_lista_rejeicoes = true"></button-->
                              Cód. Referência - Designação da Referência
                            </div>

                            <div class="table-row-column col-md-2" style="padding-top: 8px;">Fase</div>
                            <div class="table-row-column col-md-1" style="padding-top: 8px;">Área Peça</div>
                            <div class="table-row-column col-md-1"> Total Produzido</div>
                            <div class="table-row-column col-md-1">Quantidade Rejeição</div>
                            <div class="table-row-column col-md-1">% Rejeição</div>
                            <div class="table-row-column col-md-1" style="padding-top: 8px;">Objetivo</div>
                          </div>
                          <div id="chartcurtain" [class.classloading2]="loading"
                            style="display: none; text-align: center;">
                            Carregar...
                          </div>
                          <div style="text-align: center;" id="chartcurtain" class="classloading2"
                            *ngIf="!loading && dados_analise.length == 0">
                            Sem dados...
                          </div>
                          <div style="padding:0;" class="table-row col-md-12" *ngFor="let ref of dados_analise">
                            <div class="table-row-column col-md-12 pointer referenciacol referenciacol_hover"
                              data-toggle="collapse" id="referencia{{ref.id}}"
                              [attr.data-target]="'#collapseref'+ref.id" style="background: #d9d9d9; padding:0;"
                              [class.disabled]="ref.atualiza">
                              <div class="col-md-5" style="text-align: left;">
                                {{ref.brand}}
                                <div *ngIf="ref.atualiza" class="fa fa-spinner fa-spin"></div>
                              </div>
                              <div class="col-md-2" style="text-align: center;">
                                {{ref.fase}}
                              </div>
                              <div class="col-md-1" style="text-align: center;">
                                {{ref.areapeca | number : '1.2-2'}}
                              </div>
                              <div class="col-md-1" style="text-align: center;">
                                {{ref.produzidas}}
                              </div>
                              <div class="col-md-1" style="text-align: center;">
                                {{ref.defeito}}
                              </div>
                              <div class="col-md-1" style="text-align: center;"
                                [style.background]="(ref !=null && ref.percdefeitov > ref.objetivov)? '#fa33339c' : ''">
                                {{ref.percdefeito}}
                              </div>
                              <div class="col-md-1" style="text-align: center;">
                                {{ref.objetivo}}
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
              </p-tabPanel>
              <p-tabPanel header="Reclamações">
                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">
                    <div class="col-sm-12">
                      <div class="col-sm-12">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> Reclamações Clientes</h4>
                          </header>
                          <div class="panel-body">
                            <table class="table  table-bordered table-striped table-hover " id="tabelarejeicoes"
                              style="border: 1px solid #ddd;  ">
                              <thead>
                                <tr>
                                  <th scope="col" style="width: 190px;">Cód.</th>
                                  <th scope="col" style="text-align: left;">Referência</th>
                                  <th scope="col" style="text-align: center;">Tipo</th>
                                  <th scope="col" style="text-align: center;width: 97px;">Data Reg.
                                  </th>
                                  <th scope="col" style="text-align: center;">Revista no
                                    Muro
                                  </th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let rec of reclamacoesclientes ">
                                  <td style="text-align: left;">{{rec.codigo}}</td>
                                  <td style="text-align: left;">{{rec.referencia}}</td>
                                  <td>{{rec.tipo}}</td>
                                  <td>{{rec.data}}</td>
                                  <td>{{rec.revista_muro}}</td>
                                </tr>
                                <tr *ngIf="reclamacoesclientes.length == 0">
                                  <td colspan="5" style="text-align: center;">Sem Dados</td>
                                </tr>
                              </tbody>
                            </table>

                          </div>
                        </section>

                      </div>
                      <div class="col-sm-12">
                        <section class="panel">
                          <header class="panel-heading">
                            <h4 class="widget-h"> Reclamações Fornecedores</h4>
                          </header>
                          <div class="panel-body">
                            <table class="table  table-bordered table-striped table-hover " id="tabelarejeicoes"
                              style="border: 1px solid #ddd;   ">
                              <thead>
                                <tr>
                                  <th scope="col" style="width: 190px;">Cód.</th>
                                  <th scope="col" style="text-align: left;">Referência
                                  </th>
                                  <th scope="col" style="text-align: center;">Tipo</th>
                                  <th scope="col" style="text-align: center; width: 97px;">Data Reg.
                                  </th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let for of reclamacoesFornecedores ">
                                  <td style="text-align: left;">{{for.codigo}}</td>
                                  <td style="text-align: left;">{{for.referencia}}</td>
                                  <td>{{for.tipo}}</td>
                                  <td>{{for.data}}</td>
                                </tr>
                                <tr *ngIf="reclamacoesFornecedores.length == 0">
                                  <td colspan="4" style="text-align: center;">Sem Dados</td>
                                </tr>
                              </tbody>
                            </table>

                          </div>
                        </section>
                      </div>
                    </div>


                  </div>
                </section>
              </p-tabPanel>

              <p-tabPanel header="Planos Ação">
                <section style=" display: inline-block;  width: 100%;">
                  <div class="row" style="display: initial;">

                    <div class="col-md-12">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h">Planos de Ação</h4>
                        </header>
                        <div class="panel-body">
                          <p-dataTable #tabeladados [value]="dados" [paginator]="true" [rows]="25"
                            (onRowDblclick)="abrir($event)" [rowsPerPageOptions]="[25,50,100,'todos']"
                            expandableRows="true" [expandedRows]="lista_expand">
                            <p-column [style]="{'width':'6px','padding':'0'}" expander="true" styleClass="col-icon">
                              <ng-template pTemplate="filter" let-col>
                                <button *ngIf="lista_expand.length == 0 || lista_expand.length == null" pButton
                                  type="button" (click)="listartudo()" icon="fa-eye" style="margin-bottom: 12px;"
                                  label=" "></button>
                                <button *ngIf="lista_expand.length > 0" pButton type="button" (click)="listartudo()"
                                  style="margin-bottom: 12px;" icon="fa-eye-slash" label=" "></button>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'20px'}" field="id" header="Nº" [filter]="true"
                              [sortable]="true">
                            </p-column>
                            <p-column [style]="{'width':'25px'}" field="data_registo" header="Data Criação"
                              [filter]="true" [sortable]="true"></p-column>
                            <p-column [style]="{'width':'27px'}" field="data_objetivo" header="Data Objetivo do Plano"
                              [filter]="true" [sortable]="true">
                              <ng-template let-car="rowData" pTemplate="body">
                                <div [style.background]="car['cor']" [style.color]="car['cor_letra']">
                                  {{car['data_objetivo']}}
                                </div>
                              </ng-template>
                            </p-column>

                            <p-column [style]="{'width':'30px'}" field="ambito" header="Âmbito" [filter]="true"
                              [sortable]="true">
                            </p-column>
                            <p-column [style]="{'width':'60px'}" field="origem" header="Origem" [filter]="true"
                              [sortable]="true">
                            </p-column>

                            <p-column [style]="{'width':'25px'}" field="utilizador" header="Responsável do Plano"
                              [filter]="true" [sortable]="true">
                            </p-column>
                            <p-column [style]="{'width':'50px'}" field="descricao" header="Descrição" [filter]="true"
                              [sortable]="true">
                            </p-column>

                            <p-column [style]="{'width':'30px'}" field="estado" header="Estado" [filter]="true"
                              [sortable]="true">
                              <ng-template pTemplate="filter" let-col>
                                <p-multiSelect [options]="estados" [(ngModel)]="estado_filtro"
                                  [style]="{'width':'100%'}" (onChange)="filtrar($event.value,col.field,true,'in')"
                                  styleClass="ui-column-filter">
                                </p-multiSelect>
                              </ng-template>
                              <ng-template let-car="rowData" pTemplate="body">
                                {{car['estado']}}
                              </ng-template>
                            </p-column>


                            <ng-template let-car pTemplate="rowexpansion">
                              <div class="ui-grid ui-grid-responsive ui-fluid">
                                <table class="tg">
                                  <tr>
                                    <th class="tg-wfll" style="width: 100px;">Data Objetivo Ação</th>
                                    <th class="tg-wfll" style="width: 200px;">Responsável da Ação</th>
                                    <th class="tg-wfll">Ação</th>
                                    <th class="tg-wfll">Descrição</th>
                                    <th class="tg-wfll" style="width: 100px;">FastResponse</th>
                                    <th class="tg-wfll" style="width: 110px;">Prioridade</th>
                                    <th class="tg-wfll" style="width: 168px;">Estado</th>
                                  </tr>
                                  <tr *ngFor="let col of car.filho">
                                    <td class="tg-0pky" style="min-width: 120px;" [style.background]="col.corlinha"
                                      [style.color]="col.cor_letra_linha">{{col.data_acao}}</td>
                                    <td class="tg-0pky" style="min-width: 120px;">{{col.utilizador}}</td>
                                    <td class="tg-0pky" style="min-width: 120px;">{{col.acao}}</td>
                                    <td class="tg-0pky" style="min-width: 120px;">{{col.descricao}}</td>
                                    <td class="tg-0pky" style="min-width: 120px;">
                                      <i *ngIf="col.FastResponse == false" class="material-icons"
                                        style="color: red; font-size: 20px;">close</i>
                                      <i *ngIf="col.FastResponse == true" class="material-icons"
                                        style="color: green; font-size: 20px;">check</i>
                                    </td>
                                    <td class="tg-0pky" style="min-width: 120px;">{{col.prioridade}}</td>
                                    <td class="tg-0pky" style="min-width: 120px;">{{col.estado}}</td>
                                  </tr>
                                </table>
                              </div>
                            </ng-template>

                          </p-dataTable>
                        </div>
                      </section>
                    </div>
                  </div>
                </section>
              </p-tabPanel>


              <p-tabPanel header="Financeira">
                <section style=" display: inline-block;  width: 100%;">
                  <!--mini statistics start-->
                  <div class="row" style="display: inline-block; width: 100%; margin-left: 0; margin-top: 15px;">

                    <div class="col-md-8">
                      <!--earning graph start-->
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Dívidas/Vendas</h4>
                        </header>
                        <div class="panel-body">
                          <div class="region-stats">
                            <div class="row">
                              <div class="col-md-7">
                                <div class="region-earning-stats">
                                  Valor Vendas<span>{{valor_vendas | number: '1.2-2'}} €</span>
                                </div>
                                <ul class="clearfix location-earning-stats">
                                  <li class="stat-divider">
                                    <span class="first-city">{{totaldividavenc | number: '1.2-2'}} €</span>
                                    Valor em Dívida Vencida
                                  </li>
                                  <li class="stat-divider">
                                    <span class="second-city">&nbsp;</span>
                                    VS
                                  </li>
                                  <li>
                                    <span class="third-city">{{totalnaovencido | number: '1.2-2'}} €</span>
                                    Valor Não Vencido
                                  </li>
                                </ul>
                              </div>
                              <div class="col-md-5">
                                <div id="graph-area" class="main-chart  analiseplanosestrategicos"
                                  style="height: 280px; padding: 0 !important;">
                                  <p-chart type="bar" [data]="data_ValoresEmDivida" [options]="options_ValoresEmDivida"
                                    height="280"> </p-chart>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>
                      <!--earning graph end-->
                    </div>

                    <div class="col-md-4">
                      <div class="col-md-12">
                        <div class="mini-stat clearfix">
                          <span class="mini-stat-icon tar"><i class="fa fa-euro"></i></span>
                          <div class="mini-stat-info">
                            <span>{{totaldivida | number: '1.2-2'}} €</span>
                            Total Pendente em Curso
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <div class="mini-stat clearfix">
                          <span class="mini-stat-icon green"><i class="fa fa-line-chart"></i></span>
                          <div class="mini-stat-info">
                            <span>{{average_due | number: '1.2-2'}}</span>
                            Prazo médio de Recebimentos (dias)
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <div class="mini-stat clearfix">
                          <span class="mini-stat-icon orange"><i class="fa fa-percent"></i></span>
                          <div class="mini-stat-info">
                            <span>{{total_dev | number: '1.0-0'}} %</span>
                            % Dívida > 31 dias
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                  <div class="row" style="display: initial;">
                    <div class="col-sm-6">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Cumprimento dos Objetivos de Vendas</h4>
                        </header>
                        <div class="panel-body analiseplanosestrategicos" style="height: 350px;">
                          <p-chart type="line" [data]="data_CumprimentoObjetivos"
                            [options]="options_CumprimentoObjetivos" height="350"> </p-chart>
                        </div>
                      </section>
                    </div>

                    <div class="col-sm-6">
                      <section class="panel">
                        <header class="panel-heading">
                          <h4 class="widget-h"> Variação do Stock</h4>
                        </header>
                        <div class="panel-body analiseplanosestrategicos" style="height: 350px;">
                          <p-chart type="line" [data]="data_VariacaoStock" [options]="options_VariacaoStock"
                            height="350">
                          </p-chart>
                        </div>
                      </section>
                    </div>
                  </div>

                </section>
              </p-tabPanel>
            </p-tabView>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
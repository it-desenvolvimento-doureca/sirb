<div class="col-md-12  hidden-xs">
  <div class="card-header" data-background-color="orange">
    <div class="nav-tabs-navigation">
      <div class="nav-tabs-wrapper">
        <ul class="nav nav-tabs" style="background:black">
          <li [hidden]="!btvoltar">
            <a (click)=" backClicked()">
              <i class="material-icons">arrow_back</i>Voltar
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [class.disabled]="disCriar" [hidden]="!btcriar">
            <a (click)="novaderrogacao()" [ngClass]="novo ? 'cor_modo' : null">
              <i class="material-icons">create_new_folder</i>Novo
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [class.disabled]="disEditar" [hidden]="!bteditar">
            <a (click)="edita()" [ngClass]="(modoedicao && !novo) ? 'cor_modo' : null">
              <i class="material-icons">mode_edit</i>Editar
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [class.disabled]="disEmCurso" [hidden]="!btEmCurso">
            <a (click)="emCurso()">
              <i class="material-icons">schedule_send</i>Em Curso
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [class.disabled]="disFechar" [hidden]="!btfechar">
            <a (click)="fechar()">
              <i class="material-icons">done</i>Validar
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [class.disabled]="disPendente" [hidden]="!btpendente">
            <a (click)="pendente()">
              <i class="material-icons">history</i>Pendente
              <div class="ripple-container"></div>
            </a>
          </li>

          <li [class.disabled]="disApagar" [hidden]="!btapagar" style="float: right;">
            <a (click)="apagar()">
              <i class="material-icons">delete</i>Anular
              <div class="ripple-container"></div>
            </a>
          </li>
          <!--li [hidden]="!btanterior" style="display: inline-block; position: fixed; right: 52%;">
            <a (click)="anterior()">
              <i class="material-icons">keyboard_arrow_left</i>
              <div class="ripple-container"></div>
            </a>
          </li>
          <li [hidden]="!btseguinte" style="display: inline-block; position: fixed; right: 49%;">
            <a (click)="seguinte()">
              <i class="material-icons">keyboard_arrow_right</i>
              <div class="ripple-container"></div>
            </a>
          </li-->
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header" style="height: 49px; padding-top: 22px;" data-background-color="red">
            <h4 style="position: absolute;" class="title">Derrogações</h4>
            <h5 *ngIf="texto_estado != ''" style="position: absolute; right: 36px; " class="title">Estado:
              <b [style.color]="getcolor(estado)">{{texto_estado}}</b>
              <span *ngIf="data_FECHO != null && estado == 'F'">({{getResponsavel(utz_FECHO)}} -
                {{data_FECHO_texto}})</span>
            </h5>

          </div>
          <div class="card-content">
            <form (keydown.enter)="$event.preventDefault()" #form id="formReclama" (ngSubmit)="gravar()"
              ngNativeValidate>
              <div class="container-fluid" style="padding: 0;">

                <p-panel header="DETALHES" [toggleable]="false" [style]="{'margin-bottom':'0px'}">
                  <div style="display: inline-block;">
                    <div style="padding: 1px 5px 1px 10px; height: 52px;" class="form-group col-md-6 col-lg-1">
                      <label>Nº:</label>
                      <input [disabled]="true" type="text" class="form-control2" [(ngModel)]="id_DERROGACAO"
                        [ngModelOptions]="{standalone: true}">
                    </div>

                    <div style="padding: 1px 5px 1px 10px; height: 48px;" class="form-group col-md-6 col-lg-2">
                      <label style="display: -webkit-box;">Data Registo:</label>
                      <p-calendar [disabled]="true" [style]="{'height':'25px','width':'55%'}" dateFormat="yy-mm-dd"
                        placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2050"
                        [(ngModel)]="data_CRIA" [ngModelOptions]="{standalone: true}" [showIcon]="false"
                        [required]="true"></p-calendar>
                      <input [disabled]="true" style="width:38%; padding: 5px 4px;height: 25px;" [(ngModel)]="hora_CRIA"
                        [ngModelOptions]="{standalone: true}" type="time"
                        class="inputn ng-tns-c9-3 ui-inputtext ui-widget ui-state-default ui-corner-all"
                        ng-reflect-ng-class="ui-inputtext ui-widget ui-stat" required="true" placeholder="hh:mm">
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                      <label style="display: -webkit-box;">Data de Início:</label>
                      <p-calendar [disabled]="!modoedicao" [style]="{'height':'25px','width':'91%'}"
                        dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                        yearRange="2000:2050" [(ngModel)]="data_INICIO" [ngModelOptions]="{standalone: true}"
                        [showIcon]="true" [required]="true"></p-calendar>
                    </div>

                    <div style="padding: 1px 5px 1px 10px; height: 52px;" class="form-group col-md-6 col-lg-3">
                      <label>Interna/Externa:</label>
                      <br>
                      <p-dropdown [filter]="true" [options]="drop_interna_EXTERNA"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="interna_EXTERNA"
                        [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                    </div>

                    <div style="padding: 1px 5px 1px 10px; height: 52px;" class="form-group col-md-6 col-lg-3">
                      <label style="display: -webkit-box;">Data de Fim:</label>
                      <!--input placeholder="yyyy-mm-dd ou texto" [disabled]="!modoedicao" type="text"
                        [required]="interna_EXTERNA == 'I'" class="form-control2" [(ngModel)]="data_FIM"
                        [ngModelOptions]="{standalone: true}"-->
                      <p-calendar [disabled]="!modoedicao" [style]="{'height':'25px','width':'91%'}"
                        dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                        yearRange="2000:2050" [(ngModel)]="data_FIM" [ngModelOptions]="{standalone: true}"
                        [showIcon]="true"
                        [required]="interna_EXTERNA == 'I' || (interna_EXTERNA == 'E' && estado != 'P' && estado != 'A')">
                      </p-calendar>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                      <label>Utilizador de Registo:</label>
                      <p-dropdown [filter]="true" [options]="drop_utilizadores"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="utz_CRIA"
                        [ngModelOptions]="{standalone: true}" [disabled]="true" [required]="true"></p-dropdown>
                    </div>


                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                      <label>Emissor:</label>
                      <p-dropdown [filter]="true" [options]="drop_utilizadores"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="emissor"
                        [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                      <label>Unidade:</label>
                      <p-dropdown [filter]="true" [options]="unidades"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="unidade"
                        [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                      <label>Setor:</label>
                      <p-dropdown [filter]="true" [options]="seccoes"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="setor"
                        [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                    </div>


                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-12">
                      <label>Motivo da derrogação</label>
                      <textarea [disabled]="!modoedicao " pInputTextarea [(ngModel)]="motivo" class="form-control2"
                        [ngModelOptions]="{standalone: true}" style="height: 45px; width: 100%;"></textarea>
                    </div>
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-12">
                      <label>Causa</label>
                      <textarea [disabled]="!modoedicao " pInputTextarea [(ngModel)]="causa" class="form-control2"
                        [ngModelOptions]="{standalone: true}" style="height: 45px; width: 100%;"></textarea>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="plano_ACOES">Plano de Ações</label>
                      <p-checkbox [disabled]="!modoedicao" [(ngModel)]="plano_ACOES" binary="true"
                        [ngModelOptions]="{standalone: true}"></p-checkbox>
                    </div>
                  </div>
                </p-panel>
                <p-panel header="DADOS DO CLIENTE" [toggleable]="false" [style]="{'margin-bottom':'0px'}">
                  <div style="display: inline-block; width: 100%;">
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-6">
                      <label>Cliente:</label>
                      <br>
                      <p-dropdown [filter]="true" #dropc (onChange)="getMoradas(dropc.value.id)"
                        [options]="drop_cliente"
                        [style]="{'width':'calc(100% - 40px)','height':'25px','background':'white'}"
                        [(ngModel)]="cliente" [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao"
                        [required]="true"></p-dropdown>
                      <button type="button" style="width: 33px; padding-left: 11px; margin: 0;"
                        class="btn btn-danger btn-xs" [disabled]="!modoedicao   " title="Limpar" (click)="limpar()">
                        <span class="glyphicon glyphicon-remove"></span>
                      </button>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-6">
                      <label>Morada Cliente:</label>
                      <br>
                      <p-dropdown [filter]="true" #dropa (onChange)="getArtigos(dropa.value.id)"
                        [options]="drop_moradas" [style]="{'width':'100%','height':'25px','background':'white'}"
                        [(ngModel)]="morada_CLIENTE" [ngModelOptions]="{standalone: true}"
                        [disabled]="!modoedicao || !(drop_moradas.length > 0)" [required]="true"></p-dropdown>
                    </div>
                  </div>
                </p-panel>

                <p-panel header="DADOS DA REFERÊNCIA" [toggleable]="false">
                  <div style="display: inline-block; width: 100%;">
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-5">
                      <label>Referência:</label>
                      <p-dropdown *ngIf="cliente != '' && cliente != null && !getbyreferencia" [filter]="true"
                        (onChange)="alteraReferencia($event)" [options]="drop_referencia"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="referencia"
                        [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao || !(drop_referencia.length > 0)"
                        [required]="true"></p-dropdown>
                      <p-autoComplete *ngIf="cliente == '' || cliente == null || getbyreferencia"
                        [(ngModel)]="referencia_campo" [suggestions]="filteredreferencias" class="autocompleseguranca"
                        [style]="{'width': '100%', 'height': '25px'}" forceSelection="true"
                        (onUnselect)="filteronUnselect($event)" (onSelect)="filterSelect($event)"
                        emptyMessage="Sem Resultados..." [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao"
                        [required]="true" (completeMethod)="filterRef($event)" field="label" placeholder="Pesquisar..."
                        [minLength]="1">
                      </p-autoComplete>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-5">
                      <label>Designação:</label>
                      <input [disabled]="!modoedicao || !(drop_referencia.length > 0)" type="text" class="form-control2"
                        [(ngModel)]="designacao_REF" [ngModelOptions]="{standalone: true}">
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-4 col-lg-1">
                      <label>Família:</label>
                      <input required="true" [disabled]="!modoedicao || !(drop_referencia.length > 0)" type="text"
                        class="form-control2" [(ngModel)]="familia_REF" [ngModelOptions]="{standalone: true}">
                    </div>


                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-1">
                      <label>Quant.:</label>
                      <input [disabled]="!modoedicao" type="number" class="form-control2" [(ngModel)]="qtd"
                        [ngModelOptions]="{standalone: true}">
                    </div>


                  </div>
                </p-panel>


                <p-panel *ngIf="plano_ACOES" header="AÇÕES" [toggleable]="false">
                  <div style="display: inline-block; width: 100%;">
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabelaaccoes"
                      styleClass="ExcelTable2007">
                      <p-column [style]="{'width':'45px'}" styleClass="heading" field="ordem">
                        <ng-template let-col let-car="rowData" styleClass="heading" pTemplate="body">
                          <!-- {{car[col.field] }}º-->
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="descricao" [style]="{'width':'380px'}" header="PLANO AÇÃO">

                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car['descricao'] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor" let-index="rowIndex">
                          <p-dropdown [filter]="true" (onChange)="car['descricao'] = nomeACCAO($event)"
                            [options]="drop_accoes" [style]="{'width':'80%','height':'25px','background':'white'}"
                            [(ngModel)]="car['id_ACCOES']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao  ||  car['id'] != null" appendTo="body" [required]="true">
                          </p-dropdown>

                          <button type="button" class="btn btn-success btn-xs"
                            [disabled]="!modoedicao || !acessoadicionarACCAO  ||  car['id'] != null" title="Adicionar"
                            (click)="showDialogToAdd()">
                            <span class="glyphicon glyphicon-plus"></span>
                          </button>
                        </ng-template>

                      </p-column>
                      <p-column [editable]="true" field="responsavel" header="RESPONSÁVEL">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{getResponsavelaccoes(car[col.field]) }}
                        </ng-template>
                        <ng-template let-index="rowIndex" let-col let-car="rowData" pTemplate="editor">
                          <select (change)="alterarEmail2(index,$event,'tabelaaccoes')"
                            [ngClass]="car['id'] != null? 'disabled' : ''" [(ngModel)]="car['responsavel']"
                            [ngModelOptions]=" {standalone: true}" class="form-control2">
                            <optgroup [label]="i.label" *ngFor="let i of drop_utilizadores_acoes">
                              <option [selected]="f.value == car['responsavel']" [value]="f.value"
                                *ngFor="let f of i.itens">{{f.label}}</option>
                            </optgroup>
                          </select>
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="area" [style]="{'width':'85px'}" header="ÁREA">
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao ||  car['id'] != null" [(ngModel)]="car['area']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text">
                        </ng-template>
                      </p-column>
                      <p-column [editable]="false" field="data_PREVISTA" header="DATA PREVISTA">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          <!-- -->
                          <p-calendar [disabled]="!modoedicao  ||  car['id'] != null"
                            *ngIf="modoedicao  &&  car['id'] == null" [style]="{'height':'25px','width':'90%'}"
                            dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true"
                            [yearNavigator]="true" yearRange="2000:2050" [required]="true"
                            [(ngModel)]="car['data_PREVISTA']" appendTo="body" [ngModelOptions]="{standalone: true}">
                          </p-calendar>
                          <span *ngIf="!modoedicao  ||  car['id'] != null"> {{car[col.field] | date:
                            'yyyy-MM-dd'}}</span>
                        </ng-template>
                        <!--ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="!modoedicao  ||  car['id'] != null"
                            [style]="{'height':'25px','width':'90%'}" dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd"
                            [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2050" [required]="true"
                            [(ngModel)]="car['data_PREVISTA']" appendTo="body" [ngModelOptions]="{standalone: true}">
                          </p-calendar>
                        </ng-template-->
                      </p-column>
                      <p-column [editable]="true" field="data_REAL" header="DATA REAL">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] | date: 'yyyy-MM-dd'}}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="!modoedicao ||   car['data_REAL'] != null || car['estado'] == 'C'"
                            [style]="{'height':'25px','width':'90%'}" dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd"
                            [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2050"
                            [(ngModel)]="car['data_REAL']" appendTo="body" [ngModelOptions]=" {standalone: true}">
                          </p-calendar>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="false" field="nome_estado" header="ESTADO">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <span *ngIf="car['id_TAREFA']==null" class="ui-cell-data">{{car['nome_estado']}}</span>
                          <a *ngIf="car['id_TAREFA']!=null" (click)="IrPara(car['id_TAREFA'],car['responsavel'])"
                            class="ui-cell-data">{{car['nome_estado']}}</a>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="observacoes" header="OBSERVAÇÕES">
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao ||  car['id'] != null" [(ngModel)]="car['observacoes']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text">
                        </ng-template>
                      </p-column>

                      <p-column>
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-default btn-xs"
                            [disabled]="!modoedicao || car['id'] !=null" title="Obriga a Evidências"
                            (click)="car['obriga_EVIDENCIAS'] = !car['obriga_EVIDENCIAS']">
                            <span [hidden]="car['obriga_EVIDENCIAS']" class="glyphicon glyphicon-unchecked"></span>
                            <span [hidden]="!car['obriga_EVIDENCIAS']" class="glyphicon glyphicon-check"></span>
                          </button>

                          <button type="button" class="btn btn-danger btn-xs"
                            [disabled]="!modoedicao ||  car['estado'] == 'A' || car['estado'] == 'C'  " title="Apagar"
                            (click)="apagar_linha('tabelaaccoes', index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>

                          <button type="button" class="btn btn-success btn-xs"
                            [disabled]="!modoedicao || car['id'] ==null ||  car['estado'] == 'A' || car['estado'] == 'C'"
                            title="Finalizar" (click)="finalizar_linha('tabelaaccoes', index)">
                            <span [hidden]="car['concluido_UTZ'] != null" class="glyphicon glyphicon-unchecked"></span>
                            <span [hidden]="car['concluido_UTZ'] == null" class="glyphicon glyphicon-check"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_linha('tabelaaccoes')" [class.disabled]="!modoedicao  "
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>
                </p-panel>

                <p-panel header="DOCUMENTOS" [toggleable]="false" [style]="{'margin-bottom':'20px'}">
                  <div style="display: inline-block; width: 100%;">
                    <div class="form-group col-md-4 col-lg-4">
                      <p-fileUpload [disabled]="!modoedicao" #fileInput name="myfile[]" customUpload="true"
                        (uploadHandler)="onUpload($event)" multiple="multiple" maxFileSize="10000000"
                        invalidFileSizeMessageSummary="{0}: Tamanho do ficheiro inválido, "
                        invalidFileTypeMessageDetail="tipos de ficheiros permitidos: {0}."
                        invalidFileSizeMessageDetail="O tamanho máximo do upload é {0}."
                        invalidFileTypeMessageSummary="{0}: tipo de ficheiro inválido, " chooseLabel="Selecionar"
                        uploadLabel="Carregar" cancelLabel="Cancelar">
                        <ng-template let-file pTemplate="file">
                          <div class="ui-fileupload-row">
                            <div>
                              <img [src]="file.objectURL" *ngIf="isImage(file)" [width]="25" />
                              <img [src]="fileImage(file)" *ngIf="!isImage(file)" [width]="25" />
                            </div>
                            <div>{{file.name}}</div>
                            <input type="text" placeholder="Descrição" style="margin-top: 9px;" class="form-control2"
                              [(ngModel)]="filedescricao[fileInput.files.indexOf(file)]"
                              [ngModelOptions]="{standalone: true}">
                            <div>
                              <button icon="fa-close" pButton type="button" label="Remove"
                                (click)="removeFile(file, fileInput)"></button>
                            </div>
                          </div>
                        </ng-template>
                        <ng-template pTemplate="content">
                          <div style="text-align: -webkit-center; width: 100%; color: gainsboro;">Upload Files</div>
                        </ng-template>
                      </p-fileUpload>
                    </div>

                    <div class="form-group col-md-8 col-lg-8">
                      <!-- <div *ngIf="uploadedFiles.length">
                        <div *ngFor="let file of uploadedFiles" class="ui-fileupload-row" style="float: left;border: 1px solid blue;">
                          <div>{{file.file.name}}</div>
                          <div>{{file.file.size}} bytes</div>
                          <div>{{file.descricao}} bytes</div>
                          <div>
                            <button icon="fa-close" pbutton="" type="button" ng-reflect-icon="fa-close" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only">
                              <span class="ui-button-icon-left ui-c fa fa-fw fa-close"></span>
                              <span class="ui-button-text ui-c">ui-btn</span>
                            </button>
                          </div>
                        </div>
                      </div>-->
                      <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="uploadedFiles"
                        styleClass="ExcelTable2007">
                        <p-column [style]="{'width':'20%'}" [editable]="false" field="name"
                          styleClass="ExcelTable2007tdname" header="NOME">
                          <ng-template let-col let-car="rowData" pTemplate="body">
                            <span title="{{car['name'] }}">{{car['name'] }}</span>
                          </ng-template>
                        </p-column>
                        <p-column [style]="{'width':'10%'}" [editable]="false" field="tamanho"
                          styleClass="ExcelTable2007tdname" header="TAMANHO">
                          <ng-template let-col let-car="rowData" pTemplate="body">
                            <span title=" {{car['size'] }} bytes"> {{car['size'] }} bytes</span>
                          </ng-template>
                        </p-column>
                        <p-column [style]="{'width':'10%'}" [editable]="false" field="descricao"
                          styleClass="ExcelTable2007tdname" header="DESCRIÇÃO">
                          <ng-template let-col let-car="rowData" pTemplate="body">
                            <span title="{{car['descricao']}}">{{car['descricao']}}</span>
                          </ng-template>
                        </p-column>
                        <p-column [style]="{'width':'15%'}" [editable]="false" field="datacria" header="DATA">
                          <ng-template let-col let-car="rowData" pTemplate="body">
                            <span title="{{car['datacria']}}">{{car['datacria']}}</span>
                          </ng-template>
                        </p-column>
                        <p-column [style]="{'width':'10%'}" [editable]="false" field="utilizador"
                          styleClass="ExcelTable2007tdname" header="UTILIZADOR">
                          <ng-template let-col let-car="rowData" pTemplate="body">
                            <span title="{{car['utilizador']}}">{{car['utilizador']}}</span>
                          </ng-template>
                        </p-column>

                        <p-column [style]="{'width':'105px'}" [editable]="false" field="descricao" header="">
                          <ng-template let-car="rowData" let-index="rowIndex" pTemplate="body">
                            <button type="button" class="btn btn-default btn-xs" title="Ver Ficheiro"
                              (click)="showDialog(car.type, car.src,car.name,car.datatype,car.ficheiro)">
                              <i class="glyphicon glyphicon-zoom-in"></i>
                            </button>
                            <a class="btn btn-primary btn-xs" title="Download"
                              (click)="download(car.name,car.src,car.datatype,car.ficheiro)" target="_blank"
                              style="padding: 3px 0px 3px 12px; margin: 0;">
                              <i class="glyphicon glyphicon-download"></i>
                            </a>
                            <button style="padding: 3px 0px 3px 12px; margin: 3px 0 3px 0;" type="button"
                              class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                              (click)="removerficheiro(index)">
                              <span class="glyphicon glyphicon-trash"></span>
                            </button>
                          </ng-template>
                        </p-column>
                      </p-dataTable>
                    </div>


                  </div>
                </p-panel>
                <p-panel header="EQUIPA" [toggleable]="false" [style]="{'margin-bottom':'20px'}">
                  <div style="display: inline-block; width: 100%;">
                    <span class="input-group-btn" style="padding: 0; width: 30%; display: block; font-size: 12px;">
                      <button [disabled]="!modoedicao" (click)="displaygrupos = true" class="btn btn-default"
                        type="button" style="width: 100%;">Adicionar
                        a partir de um Grupo</button>
                    </span>
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabelaEquipa"
                      styleClass="ExcelTable2007">
                      <p-column [editable]="true" field="responsavel" header="Responsável">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{getResponsavel(car[col.field])}}
                        </ng-template>
                        <ng-template let-index="rowIndex" let-col let-car="rowData" pTemplate="editor">
                          <p-dropdown [filter]="true" (onChange)="alterarEmail(index,$event)" appendTo="body"
                            [options]="drop_utilizadores2"
                            [style]="{'width':'100%','height':'25px','background':'white'}"
                            [(ngModel)]="car['responsavel']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao" [required]="true"></p-dropdown>
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="email" header="Email">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao" type="text" class="form-control2" [(ngModel)]="car['email']"
                            [ngModelOptions]="{standalone: true}" appendTo="body" style="width: 100%; float: left;" />
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="telefone" header="Telefone">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao" type="text" class="form-control2"
                            [(ngModel)]="car['telefone']" [ngModelOptions]="{standalone: true}" appendTo="body"
                            style="width: 100%; float: left;" />
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="area" header="Área">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao" type="text" class="form-control2" [(ngModel)]="car['area']"
                            [ngModelOptions]="{standalone: true}" appendTo="body" style="width: 100%; float: left;" />
                        </ng-template>
                      </p-column>
                      <p-column>
                        <ng-template let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_tabelaEquipa(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_tabelaEquipa()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>
                </p-panel>

              </div>
              <button type="reset" (click)="backview()" class="btn btn-danger pull-right"
                [hidden]="!modoedicao">Cancelar</button>
              <button type="submit" class="btn btn-success pull-right" [hidden]="!modoedicao">Gravar</button>
              <div class="clearfix"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<button type="button" class="btn btn-danger btn-block" #inputnotifi [hidden]="true"
  onclick="demo.showNotification('top','right','Inseriu com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputgravou [hidden]="true"
  onclick="demo.showNotification('top','right','Alterado com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputapagar [hidden]="true"
  onclick="demo.showNotification('top','right','Anulado com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputerro [hidden]="true"
  onclick="demo.showNotification('top','right','ERRO!! Registo não foi Gravado!',4)"></button>
<button type="button" class="btn btn-danger btn-block" #inputerro2 [hidden]="true"
  onclick="demo.showNotification('top','right','ERRO!! Erro ao Traduzir!',4)"></button>
<button type="button" class="btn btn-danger btn-block" #inputartigoexiste [hidden]="true"
  onclick="demo.showNotification('top','right','Artigo já existe na Lista de Artigos Similares ou é Igual à Referência Principal!',4)"></button>
<button type="button" class="btn btn-danger btn-block" #inputerroficheiro [hidden]="true"
  onclick="demo.showNotification('top','right','ERRO!! Falha no Download!',4)"></button>
<button #escondebt id="editarclick4" data-toggle="modal" [hidden]="true"></button>
<button #alteraeditar id="editarclick2" data-toggle="modal" [hidden]="true"></button>
<button #alteraeditar2 id="editarclick3" data-toggle="modal" [hidden]="true"></button>
<button #alteracancelar id="cancelaclick1" data-toggle="modal" [hidden]="true"></button>

<p-dialog header="Aviso" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}" [dismissableMask]="true"
  appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayvalidacao" [modal]="true">
  <div style="width: 80vw; text-align: -webkit-center;">
    <h6>{{errovalida}}</h6>
  </div>
</p-dialog>




<p-dialog header="Aviso" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}" [dismissableMask]="true"
  appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayverificar" [modal]="true">
  <form role="form">
    <!-- Modal Body -->
    <div style="padding: 0px 50px 0px 50px">
      <span [innerHTML]="mensagem_verifica" style="font-size: 17px;"></span>
    </div>
    <!-- Modal Footer -->
    <div class="" style="text-align: -webkit-center;">
      <button type="button" class="btn btn-default" (click)="displayverificar = false">Fechar</button>

    </div>
  </form>
</p-dialog>


<p-dialog [responsive]="true" [closable]="false" styleClass="dialogloading" [positionTop]="0"
  [style]="{'max-height':'99vh','background': 'transparent','border': 'none','box-shadow': 'none'}"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayLoading"
  [modal]="true">
  <div class="container">
    <div class="row">
      <div id="loading">
        <ul class="bokeh">
          <li></li>
          <li></li>
          <li></li>
        </ul>
      </div>
    </div>
  </div>
</p-dialog>


<p-dialog [header]="nomeficheiro" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="display"
  [modal]="true">
  <div style="width: 80vw; text-align: -webkit-center;">
    <audio *ngIf="type == 'audio' && display" [src]="srcelement" id="player" style="max-height: 79vh; max-width: 100%;"
      autoplay="" controls="">Your
      browser does not support the audio element.</audio>
    <iframe *ngIf="( type == 'txt')  && display" class="embed-responsive-item"
      style="width: 100%; max-height: 90vh; height: 79vh; max-width: 100%;" [src]="srcelement" type="application/pdf"
      scale="aspect" frameborder="0"></iframe>
    <div *ngIf="(type == 'pdf' )  && display" style="width: 100%; max-height: 90vh; height: 79vh; max-width: 100%;">
      <object *ngIf="(type == 'pdf' )  && display" class="embed-responsive-item"
        style="width: 100%; max-height: 90vh; height: 79vh; max-width: 100%;" [data]="srcelement" type="application/pdf"
        scale="aspect" frameborder="0"></object>
    </div>
    <img *ngIf="type == 'img' && display" [src]="srcelement" style="max-height: 79vh; max-width: 100%;">
    <video *ngIf="type == 'video' && display" [src]="srcelement" id="player" style="max-height: 79vh; max-width: 100%;"
      autoplay="" controls="">Video
      format or MIME type is not supported</video>
  </div>
</p-dialog>


<!-- ADICIONAR ACÇÔES -->

<!-- Modal dados-->

<p-dialog header="Ações de Reclamações" [responsive]="true" [positionTop]="0"
  [style]="{'max-height':'99vh','width': '100%'}" [dismissableMask]="true" appendTo="body" [closeOnEscape]="true"
  [draggable]="false" [(visible)]="displayAddAccao" [modal]="true">

  <!-- Modal Header -->

  <form role="form" ngNativeValidate (ngSubmit)="gravardados()">
    <!-- Modal Body -->
    <div class="">
      <div class="form-group">
        <label for="descricao">Descrição PT</label>
        <input autocomplete="off" type="text" class="form-control2" id="descricaopt" [(ngModel)]="descricaopt"
          [ngModelOptions]="{standalone: true}" placeholder="Introduza a Descrição em Português" required />
      </div>
      <div class="form-group">
        <label for="descricao">Descrição ENG</label>
        <input autocomplete="off" type="text" class="form-control2" id="descricaoeng" [(ngModel)]="descricaoeng"
          [ngModelOptions]="{standalone: true}" placeholder="Introduza a Descrição em Inglês" />
      </div>
      <div class="form-group">
        <label for="descricao">Descrição FR</label>
        <input autocomplete="off" type="text" class="form-control2" id="descricaofr" [(ngModel)]="descricaofr"
          [ngModelOptions]="{standalone: true}" placeholder="Introduza a Descrição em Francês" />
      </div>
    </div>
    <!-- Modal Footer -->
    <div class="">
      <button type="button" class="btn btn-default" (click)="displayAddAccao = false">Fechar</button>
      <button type="submit" class="btn btn-success ">Gravar</button>
    </div>
  </form>

</p-dialog>


<!-- POPUP GRUPOS -->

<p-dialog header="Grupos" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}" [dismissableMask]="true"
  appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displaygrupos" [modal]="true">

  <p-dataTable (onRowDblclick)="escolhergrupo($event.data)"
    [style]="{'width':'100%','max-height':'67vh','overflow':'auto'}" [value]="tabelagrupos" styleClass="ExcelTable2007"
    [rows]="15" [paginator]="true" [pageLinks]="3" [rowsPerPageOptions]="[15,25,50,100,'todos']">
    <p-column [sortable]="true" [filter]="true" field="label" header="DESIGNAÇÃO">
    </p-column>
    <p-column [style]="{'width':'65px'}">
      <ng-template let-car="rowData" let-index="rowIndex" pTemplate="body">
        <button type="button" class="btn btn-success btn-xs" [disabled]="!modoedicao" title="Escolher"
          (click)="escolhergrupo(car)">
          <span class="glyphicon glyphicon-play-circle"></span>
        </button>
      </ng-template>
    </p-column>
  </p-dataTable>
  <p-footer>
    <button style="float: right; margin-right: 17px;" type="button" class="btn btn-default"
      (click)="displaygrupos = false">Fechar</button>
  </p-footer>
</p-dialog>
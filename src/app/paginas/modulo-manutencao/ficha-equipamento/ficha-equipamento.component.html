<app-controlos (apagarbt)="apagar()" (duplicarbt)="duplicar()"></app-controlos>
<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header" style="height: 49px; padding-top: 22px;" data-background-color="red">
            <h4 style="position: absolute;" class="title">Equipamentos</h4>

          </div>
          <div class="card-content">
            <form (keydown.enter)="$event.preventDefault()" #form id="formReclama" (ngSubmit)="gravar()"
              ngNativeValidate>

              <div class="btn-pref btn-group-justified btn-group-lg" role="group" aria-label="...">

                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='1';" style="padding: 12px;" [class.ativobt]="ativobt == '1'" type="button"
                    id="stars" class="btn " href="#tab1" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;"> Dados Equipamento</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='2';" style="padding: 12px;" [class.ativobt]="ativobt == '2'" type="button"
                    id="stars" class="btn " href="#tab2" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;"> Graus de Importância</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='3';" style="padding: 12px;" [class.ativobt]="ativobt == '3'" type="button"
                    id="favorites" class="btn" href="#tab3" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;">Lista de Componentes</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='4';" style="padding: 12px;" [class.ativobt]="ativobt == '4'" type="button"
                    id="favorites" class="btn" href="#tab4" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;" title="Planos de Manutenção (Preventiva)">Planos
                      de Man. (Prev.)</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='5';" style="padding: 12px;" [class.ativobt]="ativobt == '5'" type="button"
                    id="favorites" class="btn" href="#tab5" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;">Contratos Suporte</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white;">
                  <button (click)="ativobt='6';" style="padding: 12px;" [class.ativobt]="ativobt == '6'" type="button"
                    id="favorites" class="btn" href="#tab6" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;">Dados da Compra</div>
                  </button>
                </div>
                <div class="btn-group" role="group" style="border-right: 2px solid white; width: 0.6%;">
                  <button (click)="ativobt='7';" style="padding: 12px;" [class.ativobt]="ativobt == '7'" type="button"
                    id="favorites" class="btn" href="#tab7" data-toggle="tab"><span class="glyphicon glyphicon-th"
                      aria-hidden="true"></span>
                    <div class="hidden-xs" style="display: contents;">Histórico</div>
                  </button>
                </div>
              </div>

              <div class="well" style="display: flex; padding: 0;">
                <div class="tab-content" style="width: 100%; padding: 0;">
                  <div class="tab-pane fade in active" id="tab1">
                    <div class="col-md-12" style="padding: 0;">
                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-2">
                        <label>Código:</label>
                        <input [disabled]="true" style="width: 100%;" type="text" class="form-control2"
                          [(ngModel)]="ID_MANUTENCAO" [ngModelOptions]="{standalone: true}">
                      </div>
                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-5">
                        <label>Nome:</label>
                        <input style="width: 100%;" [disabled]="!modoedicao" type="text" class="form-control2"
                          [(ngModel)]="NOME" required [ngModelOptions]="{standalone: true}">
                      </div>
                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-5">
                        <label>Código Equipamento Principal:</label>
                        <p-dropdown [options]="drop_equipamentos"
                          [style]="{'width':'100%','height':'25px','background':'white'}"
                          [(ngModel)]="COD_EQUIPAMENTO_PRINCIPAL" [ngModelOptions]="{standalone: true}"
                          [disabled]="!modoedicao"></p-dropdown>
                      </div>

                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                        <label>Nível de Criticidade:</label>
                        <p-dropdown [options]="drop_niveis"
                          [style]="{'width':'100%','height':'25px','background':'white'}"
                          [(ngModel)]="NIVEL_CRITICIDADE" [ngModelOptions]="{standalone: true}"
                          [disabled]="!modoedicao"></p-dropdown>
                      </div>

                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                        <label>Âmbito Manutenção</label>
                        <p-dropdown [options]="drop_ambitos_manutencao" [required]="true"
                          [style]="{'width':'100%','height':'25px','background':'white'}"
                          [(ngModel)]="AMBITO_MANUTENCAO" [ngModelOptions]="{standalone: true}"
                          [disabled]="!modoedicao"></p-dropdown>
                      </div>

                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-4">
                        <label>Localização:</label>
                        <br>
                        <p-dropdown [filter]="true" [options]="drop_localizacoes"
                          [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="LOCALIZACAO"
                          [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                      </div>

                      <!--div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-3">
                        <label>Grau Importância:</label>
                        <br>
                        <p-dropdown [filter]="true" [options]="drop_grau_importancia"
                          [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="GRAU_IMPORTANCIA"
                          [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao" [required]="true"></p-dropdown>
                      </div-->
                      <div style="padding: 6px 5px 1px 10px;" class="form-group col-md-6 col-lg-2">
                        <p-radioButton label="Equipa" [disabled]="!modoedicao" name="tipo_equipa" value="E"
                          [(ngModel)]="TIPO_EQUIPA">
                        </p-radioButton>
                        <br>
                        <p-radioButton label="Utilizador" [disabled]="!modoedicao" name="tipo_equipa" value="U"
                          [(ngModel)]="TIPO_EQUIPA">
                        </p-radioButton>

                        <p-radioButton label="Externo" [disabled]="!modoedicao" name="tipo_equipa" value="EX"
                          [style]="{'margin-left':'10px'}" [(ngModel)]="TIPO_EQUIPA">
                        </p-radioButton>
                      </div>

                      <div *ngIf="TIPO_EQUIPA == 'E'" style="padding: 1px 5px 1px 10px;"
                        class="form-group col-md-6 col-lg-3">
                        <label>Equipa:</label>
                        <p-dropdown [filter]="true" [options]="drop_equipas" [disabled]="!modoedicao"
                          [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="EQUIPA"
                          [ngModelOptions]="{standalone: true}" [required]="true"></p-dropdown>
                      </div>
                      <div *ngIf="TIPO_EQUIPA == 'U'" style="padding: 1px 5px 1px 10px;"
                        class="form-group col-md-6 col-lg-3">
                        <label>Utilizador:</label>
                        <p-dropdown [filter]="true" [options]="drop_utilizadores" [disabled]="!modoedicao"
                          [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="UTILIZADOR"
                          [ngModelOptions]="{standalone: true}" [required]="true"></p-dropdown>
                      </div>
                      <div *ngIf="TIPO_EQUIPA == 'EX'" style="padding: 1px 5px 1px 10px;"
                        class="form-group col-md-6 col-lg-3">
                        <label>Utilizador Externo:</label>
                        <p-dropdown [filter]="true" [options]="drop_fornecedor" [disabled]="!modoedicao"
                          (onChange)="fornecedor($event)"
                          [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="COD_FORNECEDOR"
                          [ngModelOptions]="{standalone: true}" [required]="true"></p-dropdown>
                      </div>

                      <div *ngIf="TIPO_EQUIPA == 'EX'" style="padding: 1px 5px 1px 10px;"
                        class="form-group col-md-6 col-lg-3">
                        <label>Nome:</label>
                        <input [disabled]="true" style="width: 100%;" type="text" class="form-control2"
                          [(ngModel)]="NOME_FORNECEDOR" [ngModelOptions]="{standalone: true}">
                      </div>

                      <div *ngIf="TIPO_EQUIPA == 'EX'" style="padding: 1px 5px 1px 10px;"
                        class="form-group col-md-6 col-lg-3">
                        <label>Email:</label>
                        <input [disabled]="!modoedicao" style="width: 100%;" type="text" class="form-control2"
                          [(ngModel)]="EMAIL_FORNECEDOR" [ngModelOptions]="{standalone: true}">
                      </div>

                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-1">
                        <label for="ny">Garantia (s/n):</label>
                        <div class="ui-g-12">
                          <p-checkbox [disabled]="!modoedicao" binary="true" [(ngModel)]="GARANTIA"
                            [ngModelOptions]="{standalone: true}"></p-checkbox>
                        </div>
                      </div>

                      <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-6 col-lg-2">
                        <label *ngIf="GARANTIA" style="display: -webkit-box;">Data Validade:</label>
                        <p-calendar *ngIf="GARANTIA" [disabled]="!modoedicao" [style]="{'height':'25px','width':'50%'}"
                          dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                          yearRange="2000:2050" [required]="true" [(ngModel)]="DATA_VALIDADE"
                          [ngModelOptions]="{standalone: true}" [showIcon]="true">
                        </p-calendar>
                      </div>


                      <div class="col-md-12">
                        <label style="color: black;">Documentos:</label>
                        <br>
                        <div class="form-group col-md-5 col-lg-5">
                          <p-fileUpload [disabled]="!modoedicao" #fileInput name="myfile[]" customUpload="true"
                            (uploadHandler)="onUpload($event)" multiple="multiple" maxFileSize="10000000"
                            invalidFileSizeMessageSummary="{0}: Tamanho do ficheiro inválido, "
                            invalidFileTypeMessageDetail="tipos de ficheiros permitidos: {0}."
                            invalidFileSizeMessageDetail="O tamanho máximo do upload é {0}."
                            invalidFileTypeMessageSummary="{0}: tipo de ficheiro inválido, " chooseLabel="Selecionar"
                            uploadLabel="Carregar" cancelLabel="Cancelar">
                            <ng-template let-file pTemplate="file">
                              <div class="ui-fileupload-row">
                                <div>
                                  <img [src]="file.objectURL" *ngIf="isImage(file)" [width]="25" />
                                  <img [src]="fileImage(file)" *ngIf="!isImage(file)" [width]="25" />
                                </div>
                                <div>{{file.name}}</div>
                                <input type="text" placeholder="Descrição" style="margin-top: 9px;"
                                  class="form-control2" [(ngModel)]="filedescricao[fileInput.files.indexOf(file)]"
                                  [ngModelOptions]="{standalone: true}">
                                <div>
                                  <button icon="fa-close" pButton type="button" label="Remove"
                                    (click)="removeFile(file, fileInput)"></button>
                                </div>
                              </div>
                            </ng-template>
                            <ng-template pTemplate="content">
                              <div style="text-align: -webkit-center; width: 100%; color: gainsboro;">Upload Files</div>
                            </ng-template>
                          </p-fileUpload>
                        </div>

                        <div class="form-group col-md-7 col-lg-7">
                          <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="uploadedFiles"
                            styleClass="ExcelTable2007">
                            <p-column [style]="{'width':'20%'}" [editable]="false" field="name"
                              styleClass="ExcelTable2007tdname" header="NOME">
                              <ng-template let-col let-car="rowData" pTemplate="body">
                                <span title="{{car['name'] }}">{{car['name'] }}</span>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'10%'}" [editable]="false" field="tamanho"
                              styleClass="ExcelTable2007tdname" header="TAMANHO">
                              <ng-template let-col let-car="rowData" pTemplate="body">
                                <span title=" {{car['size'] }} bytes"> {{car['size'] }} bytes</span>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'25%'}" [editable]="false" field="descricao"
                              styleClass="ExcelTable2007tdname" header="DESCRIÇÃO">
                              <ng-template let-col let-car="rowData" pTemplate="body">
                                <span title="{{car['descricao']}}">{{car['descricao']}}</span>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'128px'}" [editable]="false" field="datacria" header="DATA">
                              <ng-template let-col let-car="rowData" pTemplate="body">
                                <span title="{{car['datacria']}}">{{car['datacria']}}</span>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'16%'}" [editable]="false" field="utilizador"
                              styleClass="ExcelTable2007tdname" header="UTILIZADOR">
                              <ng-template let-col let-car="rowData" pTemplate="body">
                                <span title="{{car['utilizador']}}">{{car['utilizador']}}</span>
                              </ng-template>
                            </p-column>
                            <p-column [style]="{'width':'125px'}" [editable]="false" field="descricao" header="">
                              <ng-template let-car="rowData" let-index="rowIndex" pTemplate="body">
                                <button type="button" class="btn btn-default btn-xs" title="Ver Ficheiro"
                                  (click)="showDialog(car.type, car.src,car.name,car.datatype,car.ficheiro,false,car.id)">
                                  <i class="glyphicon glyphicon-zoom-in"></i>
                                </button>
                                <a class="btn btn-primary btn-xs" title="Download"
                                  (click)="download(car.name,car.src,car.datatype,car.ficheiro)" target="_blank"
                                  style="padding: 3px 0px 3px 12px; margin: 0;">
                                  <i class="glyphicon glyphicon-download"></i>
                                </a>
                                <button style="padding: 3px 0px 3px 12px; margin: 3px 0 3px 0;" type="button"
                                  class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                                  (click)="removerficheiro(index)">
                                  <span class="glyphicon glyphicon-trash"></span>
                                </button>
                              </ng-template>
                            </p-column>
                          </p-dataTable>
                        </div>
                      </div>


                    </div>
                  </div>

                  <!-- Graus de Importãncia -->
                  <div class="tab-pane fade in" id="tab2">
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabelaGrauImportancia"
                      styleClass="ExcelTable2007">

                      <p-column [editable]="false" field="departamento" header="Departamento Origem">
                        <ng-template let-col let-car="rowData" pTemplate="body" let-index="rowIndex">
                          <p-dropdown [filter]="true" #vv [options]="departs" [disabled]="!modoedicao"
                            [style]="{'width':'100%'}" [(ngModel)]="car['departamento']" appendTo="body"
                            [ngModelOptions]="{standalone: true}"></p-dropdown>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="false" field="nivel" header="Nível">
                        <ng-template let-col let-car="rowData" pTemplate="body" let-index="rowIndex">
                          <p-dropdown [options]="drop_niveis" [style]="{'width':'100%'}" [(ngModel)]="car['nivel']"
                            appendTo="body" [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao"></p-dropdown>
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'80px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_linha_tabelaGrauImportancia(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_linha_tabelaGrauImportancia()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>

                  <!--  -->
                  <div class="tab-pane fade in" id="tab3">
                    <p-dataTable [style]="{'width':'100%'}" [emptyMessage]="mensagemtabela" [editable]="true"
                      [value]="tabela_lista_componentes" styleClass="ExcelTable2007">

                      <p-column [style]="{'width':'42.5%'}" [editable]="true" field="PROREF" header="Código Referência">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor" let-index="rowIndex">
                          <p-autoComplete [(ngModel)]="car['referencia_campo']"
                            [suggestions]="car['filteredreferencias']" class="autocompleseguranca"
                            [style]="{'width': '100%', 'height': '25px'}" forceSelection="true"
                            emptyMessage="Sem Resultados..." (onUnselect)="filteronUnselect($event,index)"
                            (onSelect)="filterSelect($event,index)" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao" (completeMethod)="filterRef($event,index)" field="label"
                            placeholder="Pesquisar..." [minLength]="1">
                          </p-autoComplete>
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'42.5%'}" field="DESIGN" header="Descrição">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="quantidade" [style]="{'width':'80px','padding-left':'6px'}"
                        header="Quantidade">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao" [(ngModel)]="car['quantidade']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="number">
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'85px'}" field="STOCK_TOTAL" header="Stock Total">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          <span style="cursor: pointer; color: #ffa91f;" title="Ver Localização/Stock"
                            (click)="verStock(car['PROREF'])">
                            {{car[col.field] }}</span>
                        </ng-template>
                      </p-column>

                      <!--p-column [style]="{'width':'85px'}" field="STOCK_TOTAL" header="Armazém/Localização">
                      </p-column-->

                      <p-column [editable]="false" field="anexo" header="Anexo" [style]="{ 'width':'90px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <!--input [disabled]="!modoedicao" [(ngModel)]="car['anexo']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text"-->
                          <button type="button" class="btn btn-default  btn-xs" title="Anexos"
                            [ngClass]="(car['anexo'] > 0 )?'bt_tem_anexos':''"
                            (click)="abrirdialoganexo(car,'componentes',index)">
                            <span class="glyphicon glyphicon-file"></span>
                          </button>
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'80px'}">
                        <ng-template let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_linha(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>

                      <p-footer>
                        <a (click)="adicionar_linha()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>

                  <!--  -->
                  <div class="tab-pane fade in" id="tab4">
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-12 col-lg-12">
                      <label>Descrição da Manutenção:</label>
                      <input style="width: 100%;" [disabled]="!modoedicao" type="text" class="form-control2"
                        [(ngModel)]="DESCRICAO_MANUTENCAO" [ngModelOptions]="{standalone: true}">
                    </div>
                    <button type="button" class="btn btn-warning btn-xs" [disabled]="btcriapreventiva"
                      *ngIf="acessocriarmanutencoespreventivas && !novo" title="Criar Manutenções Preventivas"
                      (click)="criarPreventivas()">
                      <span class="glyphicon glyphicon-plus"></span>Criar Manutenções Preventivas
                    </button>
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabelaaccoes"
                      styleClass="ExcelTable2007">

                      <p-column [style]="{'width':'38px'}" field="checked">
                        <ng-template pTemplate="header">
                          <p-radioButton [disabled]="!acessocriarmanutencoespreventivas" (onClick)="selectt_d('T')"
                            name="groupname" value="T" [(ngModel)]="selected_d">
                          </p-radioButton>
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          <p-checkbox name="groupROW" [value]="car.id" (onChange)=" car.checked = $event;"
                            [disabled]="car.id == null || !acessocriarmanutencoespreventivas"
                            [(ngModel)]="selected_lines">
                          </p-checkbox>

                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="descricao" header="Ação">

                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car['descricao'] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor" let-index="rowIndex">
                          <p-dropdown [filter]="true" (onChange)="car['descricao'] = nomeACCAO($event)" appendTo="body"
                            [options]="drop_accoes" [style]="{'width':'80%','height':'25px','background':'white'}"
                            [(ngModel)]="car['id_ACCOES']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao" appendTo="body">
                          </p-dropdown>

                          <button type="button" class="btn btn-success btn-xs" [disabled]="!modoedicao"
                            title="Adicionar" (click)="showDialogToAdd(index)">
                            <span class="glyphicon glyphicon-plus"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" [style]="{'width':'150px'}" field="tempo_ESTIMADO"
                        header="Tempo Estimado">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <input [disabled]="!modoedicao" style="width:80px; padding: 5px 4px;"
                            [(ngModel)]="car['tempo_ESTIMADO']" [ngModelOptions]="{standalone: true}" type="time"
                            class="ng-tns-c9-3 ui-inputtext ui-widget ui-state-default ui-corner-all"
                            ng-reflect-ng-class="ui-inputtext ui-widget ui-stat" placeholder="hh:mm">
                        </ng-template>
                      </p-column>
                      <p-column [editable]="false" [style]="{'width':'100px'}" field="periociodade"
                        header="Periodicidade">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-default  btn-xs" title="Periodicidade"
                            (click)="abrePeriodicidade(car,index)">
                            <span class="glyphicon glyphicon-time"></span>
                          </button>
                        </ng-template>
                        <!--ng-template let-index="rowIndex" let-col let-car="rowData" pTemplate="editor">
                          <p-dropdown [filter]="true" [options]="drop_periodicidade"
                            [style]="{'width':'80%','height':'25px','background':'white'}"
                            [(ngModel)]="car['periociodade']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao" appendTo="body">
                          </p-dropdown>
                        </ng-template-->
                      </p-column>

                      <p-column [editable]="true" [style]="{'width':'150px'}" field="ultima_REALIZADA"
                        header="Última Realizada">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] | date: 'yyyy-MM-dd'}}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="true" [style]="{'height':'25px','width':'90%'}" dateFormat="yy-mm-dd"
                            placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                            yearRange="2000:2050" [(ngModel)]="car['ultima_REALIZADA']" appendTo="body"
                            [ngModelOptions]="{standalone: true}">
                          </p-calendar>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" [style]="{'width':'150px'}" field="proxima_REALIZAR"
                        header="Próxima a Realizar">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] | date: 'yyyy-MM-dd'}}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="!modoedicao" [style]="{'height':'25px','width':'90%'}"
                            dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true"
                            [yearNavigator]="true" yearRange="2000:2050" [(ngModel)]="car['proxima_REALIZAR']"
                            appendTo="body" [ngModelOptions]=" {standalone: true}">
                          </p-calendar>
                        </ng-template>
                      </p-column>


                      <p-column [editable]="false" [style]="{'width':'250px'}" field="tipo_responsavel"
                        header="Tipo Responsável">
                        <ng-template let-col let-car="rowData" pTemplate="body" let-index="rowIndex">
                          <p-radioButton label="Equipa" [disabled]="!modoedicao" name="tipo_responsavel{{index}}"
                            value="E" [(ngModel)]="car['tipo_responsavel']">
                          </p-radioButton>

                          <p-radioButton label="Utilizador" [disabled]="!modoedicao" name="tipo_responsavel{{index}}"
                            value="U" [(ngModel)]="car['tipo_responsavel']">
                          </p-radioButton>
                        </ng-template>
                      </p-column>


                      <p-column [editable]="false" [style]="{'width':'250px'}" field="equipa"
                        header="Equipa/Utilizador Responsável">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          <p-dropdown *ngIf="car['tipo_responsavel'] == 'E'" [filter]="true" [options]="drop_equipas"
                            appendTo="body" [style]="{'width':'100%','height':'25px','background':'white'}"
                            [(ngModel)]="car['equipa']" [ngModelOptions]="{standalone: true}" [disabled]="!modoedicao">
                          </p-dropdown>
                          <p-dropdown *ngIf="car['tipo_responsavel'] == 'U'" [filter]="true"
                            [options]="drop_utilizadores" appendTo="body"
                            [style]="{'width':'100%','height':'25px','background':'white'}"
                            [(ngModel)]="car['utilizador']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao">
                          </p-dropdown>
                        </ng-template>
                      </p-column>


                      <p-column [style]="{'width':'80px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">

                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_linha_acoes(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>

                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_linha_acoes()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>

                  <!--  Contratos Suporte -->
                  <div class="tab-pane fade in" id="tab5">
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabelacontratossuporte"
                      styleClass="ExcelTable2007">

                      <p-column [editable]="false" field="fornecedor" [style]="{'width':'380px'}" header="Fornecedor">
                        <ng-template let-col let-car="rowData" pTemplate="body" let-index="rowIndex">
                          <p-dropdown [filter]="true" #dropc [options]="drop_fornecedor" appendTo="body"
                            [style]="{'width':'100%','height':'25px','background':'white'}"
                            [(ngModel)]="car['fornecedor'] " [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao">
                          </p-dropdown>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="contrato_suporte" [style]="{'width':'380px'}"
                        header="Contrado suporte (s/n)">

                        <ng-template let-col let-car="rowData" pTemplate="body">
                          <i *ngIf="car.contrato_suporte == false" class="material-icons" style="color: red;">close</i>
                          <i *ngIf="car.contrato_suporte == true" class="material-icons" style="color: green;">check</i>
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor" let-index="rowIndex">
                          <p-checkbox [disabled]="!modoedicao" binary="true" [(ngModel)]="car['contrato_suporte']"
                            [ngModelOptions]="{standalone: true}"></p-checkbox>
                        </ng-template>

                      </p-column>


                      <p-column [editable]="true" field="periociodade" header="Periodicidade">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{getPeriodicidade(car[col.field]) }}
                        </ng-template>
                        <ng-template let-index="rowIndex" let-col let-car="rowData" pTemplate="editor">
                          <p-dropdown [filter]="true" [options]="drop_periodicidade" appendTo="body"
                            [style]="{'width':'80%','height':'25px','background':'white'}"
                            [(ngModel)]="car['periociodade']" [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao" appendTo="body">
                          </p-dropdown>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="data_INICIO" header="Data Início">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] | date: 'yyyy-MM-dd'}}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="!modoedicao" [style]="{'height':'25px','width':'90%'}"
                            dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true"
                            [yearNavigator]="true" yearRange="2000:2050" [(ngModel)]="car['data_INICIO']"
                            appendTo="body" [ngModelOptions]="{standalone: true}">
                          </p-calendar>
                        </ng-template>
                      </p-column>

                      <p-column [editable]="true" field="data_FIM" header="Data Fim">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car[col.field] | date: 'yyyy-MM-dd'}}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor">
                          <p-calendar [disabled]="!modoedicao" [style]="{'height':'25px','width':'90%'}"
                            dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true"
                            [yearNavigator]="true" yearRange="2000:2050" [(ngModel)]="car['data_FIM']" appendTo="body"
                            [ngModelOptions]=" {standalone: true}">
                          </p-calendar>
                        </ng-template>
                      </p-column>



                      <p-column [editable]="false" field="anexo" header="Anexo" [style]="{ 'width':'90px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <!--input [disabled]="!modoedicao" [(ngModel)]="car['anexo']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text"-->
                          <button type="button" class="btn btn-default  btn-xs" title="Anexos"
                            (click)="abrirdialoganexo(car,'contrato_suporte',index)">
                            <span class="glyphicon glyphicon-file"></span>
                          </button>
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'80px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_linha_contratos_suporte(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_linha_contratos_suporte()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>

                  <!-- Dados da Compra -->
                  <div class="tab-pane fade in" id="tab6">
                    <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="tabeladadoscompra"
                      styleClass="ExcelTable2007">

                      <p-column [editable]="false" field="fornecedor" [style]="{'width':'380px'}" header="Fornecedor">
                        <ng-template let-col let-car="rowData" pTemplate="body" let-index="rowIndex">
                          <p-dropdown [filter]="true" #dropc [options]="drop_fornecedor" appendTo="body"
                            [style]="{'width':'100%','height':'25px','background':'white'}"
                            [(ngModel)]="car['fornecedor'] " [ngModelOptions]="{standalone: true}"
                            [disabled]="!modoedicao"></p-dropdown>
                        </ng-template>
                      </p-column>
                      <p-column [editable]="true" field="n_documento" [style]="{'width':'380px'}" header="Nº Documento">
                        <ng-template let-col let-car="rowData" pTemplate="body">
                          {{car['n_documento'] }}
                        </ng-template>
                        <ng-template let-col let-car="rowData" pTemplate="editor" let-index="rowIndex">
                          <input [disabled]="!modoedicao" [(ngModel)]="car['n_documento']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text">
                        </ng-template>
                      </p-column>

                      <p-column [editable]="false" field="anexo" header="Anexo" [style]="{ 'width':'90px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <!--input [disabled]="!modoedicao" [(ngModel)]="car['anexo']"
                            [ngModelOptions]="{standalone: true}"
                            class="ui-inputtext ui-widget ui-state-default ui-corner-all ng-dirty ng-valid ng-touched"
                            type="text"-->
                          <button type="button" class="btn btn-default  btn-xs" title="Anexos"
                            (click)="abrirdialoganexo(car,'dados_compra',index)">
                            <span class="glyphicon glyphicon-file"></span>
                          </button>
                        </ng-template>
                      </p-column>

                      <p-column [style]="{'width':'80px'}">
                        <ng-template let-col let-car="rowData" let-index="rowIndex" pTemplate="body">
                          <button type="button" class="btn btn-danger btn-xs" [disabled]="!modoedicao" title="Apagar"
                            (click)="apagar_linha_tabeladadoscompra(index)">
                            <span class="glyphicon glyphicon-trash"></span>
                          </button>
                        </ng-template>
                      </p-column>
                      <p-footer [style]="{'text-align':'center'}">
                        <a (click)="adicionar_linha_tabeladadoscompra()" [class.disabled]="!modoedicao"
                          style="color: black; cursor:pointer; margin-left:10px;" title="Adicionar nova linha">
                          <i class="material-icons">add</i> Adicionar
                        </a>
                      </p-footer>
                    </p-dataTable>
                  </div>

                  <!-- Historicio -->
                  <div class="tab-pane fade in" id="tab7">
                    <p-dataTable [style]="{'width':'100%'}" [value]="tabela_historico" styleClass="ExcelTable2007">

                      <p-column field="tipo_manutencao" header="Tipo Manutenção">
                      </p-column>
                      <p-column field="data_pedido" header="Data Pedido">
                      </p-column>
                      <p-column field="data_inicio" header="Data Início">
                      </p-column>
                      <p-column field="data_fim" header="Data Fim">
                      </p-column>
                      <p-column field="estado" header="Estado">
                      </p-column>

                    </p-dataTable>
                  </div>

                </div>
              </div>



              <button type="button" (click)="backview()" class="btn btn-danger pull-right"
                [hidden]="!modoedicao">Cancelar</button>
              <button type="submit" class="btn btn-success pull-right" #buttongravar [hidden]="true">Gravar</button>
              <button type="submit" class="btn btn-success pull-right" [hidden]="!modoedicao">Gravar</button>
              <div class="clearfix"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<button type="button" class="btn btn-danger btn-block" #inputnotifi [hidden]="true"
  onclick="demo.showNotification('top','right','Inseriu com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputgravou [hidden]="true"
  onclick="demo.showNotification('top','right','Alterado com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputapagar [hidden]="true"
  onclick="demo.showNotification('top','right','Apagado com Sucesso!',2)"></button>
<button type="button" class="btn btn-danger btn-block" #inputerro [hidden]="true"
  onclick="demo.showNotification('top','right','ERRO!! Registo não foi Gravado!',4)"></button>
<button type="button" class="btn btn-danger btn-block" #inputerroficheiro [hidden]="true"
  onclick="demo.showNotification('top','right','ERRO!! Falha no Download!',4)"></button>

<!-- Modal dados-->

<p-dialog header="Ações de Planos de Ação" [responsive]="true" [positionTop]="0"
  [style]="{'max-height':'99vh','width': '100%'}" [dismissableMask]="true" appendTo="body" [closeOnEscape]="true"
  [draggable]="false" [(visible)]="displayAddAccao" [modal]="true">

  <!-- Modal Header -->

  <form role="form" ngNativeValidate (ngSubmit)="gravardados()">
    <!-- Modal Body -->
    <div class="">
      <div class="form-group">
        <label for="descricao">Descrição PT</label><br>
        <input style="width: 500px;" [ngClass]="class_numexiste" autocomplete="off" type="text" class="form-control2"
          id="descricaopt" [(ngModel)]="descricaopt" [ngModelOptions]="{standalone: true}"
          placeholder="Introduza a Descrição em Português" required />
        <span style="font-size: 12px; color: red; font-weight: 500;" [hidden]="!num_existe">Ação já Existe! </span>
      </div>
    </div>
    <!-- Modal Footer -->
    <div class="" style="text-align: right;">
      <button type="button" class="btn btn-default" (click)="displayAddAccao = false">Fechar</button>
      <button type="submit" class="btn btn-success ">Gravar</button>
    </div>
  </form>

</p-dialog>

<p-dialog [header]="nomeficheiro" (onHide)="abreAnexos()" [responsive]="true" [positionTop]="0"
  [style]="{'max-height':'99vh'}" [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false"
  [(visible)]="display" [modal]="true">
  <div style="width: 80vw; text-align: -webkit-center;">
    <audio *ngIf="type == 'audio' && display" [src]="srcelement" id="player" style="max-height: 79vh; max-width: 100%;"
      autoplay="" controls="">Your
      browser does not support the audio element.</audio>
    <iframe *ngIf="(type == 'pdf' || type == 'txt')  && display" class="embed-responsive-item"
      style="width: 100%; max-height: 90vh; height: 79vh; max-width: 100%;" [src]="srcelement" type="application/pdf"
      scale="aspect" frameborder="0"></iframe>
    <img *ngIf="type == 'img' && display" [src]="srcelement" style="max-height: 79vh; max-width: 100%;">
    <video *ngIf="type == 'video' && display" [src]="srcelement" id="player" style="max-height: 79vh; max-width: 100%;"
      autoplay="" controls="">Video
      format or MIME type is not supported</video>
  </div>
</p-dialog>



<p-dialog header="Anexos" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}" [dismissableMask]="true"
  appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayFilesAnexo" [modal]="true">
  <div style="display: inline-block; width: 100%;">
    <div class="form-group col-md-4 col-lg-4">
      <p-fileUpload [disabled]="!modoedicao" #fileInputAnexos name="myfileAnexos[]" customUpload="true"
        (uploadHandler)="onUploadAnexo($event)" multiple="multiple" maxFileSize="10000000"
        invalidFileSizeMessageSummary="{0}: Tamanho do ficheiro inválido, "
        invalidFileTypeMessageDetail="tipos de ficheiros permitidos: {0}."
        invalidFileSizeMessageDetail="O tamanho máximo do upload é {0}."
        invalidFileTypeMessageSummary="{0}: tipo de ficheiro inválido, " chooseLabel="Selecionar" uploadLabel="Carregar"
        cancelLabel="Cancelar">
        <ng-template let-file pTemplate="file">
          <div class="ui-fileupload-row">
            <div>
              <img [src]="file.objectURL" *ngIf="isImage(file)" [width]="25" />
              <img [src]="fileImage(file)" *ngIf="!isImage(file)" [width]="25" />
            </div>
            <div>{{file.name}}</div>
            <input type="text" placeholder="Descrição" style="margin-top: 9px;" class="form-control2"
              [(ngModel)]="filedescricaoAnexo[fileInputAnexos.files.indexOf(file)]"
              [ngModelOptions]="{standalone: true}">
            <div>
              <button icon="fa-close" pButton type="button" label="Remove"
                (click)="removeFile(file, fileInputAnexos)"></button>
            </div>
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div style="text-align: -webkit-center; width: 100%; color: gainsboro;">Upload Files</div>
        </ng-template>
      </p-fileUpload>
    </div>

    <div class="form-group col-md-8 col-lg-8">
      <p-dataTable [style]="{'width':'100%'}" [editable]="modoedicao" [value]="uploadedFilesAnexos"
        styleClass="ExcelTable2007">
        <p-column [style]="{'width':'20%'}" [editable]="false" field="name" styleClass="ExcelTable2007tdname"
          header="NOME">
          <ng-template let-col let-car="rowData" pTemplate="body">
            <span title="{{car['name'] }}">{{car['name'] }}</span>
          </ng-template>
        </p-column>
        <p-column [style]="{'width':'10%'}" [editable]="false" field="tamanho" styleClass="ExcelTable2007tdname"
          header="TAMANHO">
          <ng-template let-col let-car="rowData" pTemplate="body">
            <span title=" {{car['size'] }} bytes"> {{car['size'] }} bytes</span>
          </ng-template>
        </p-column>
        <p-column [style]="{'width':'25%'}" [editable]="false" field="descricao" styleClass="ExcelTable2007tdname"
          header="DESCRIÇÃO">
          <ng-template let-col let-car="rowData" pTemplate="body">
            <span title="{{car['descricao']}}">{{car['descricao']}}</span>
          </ng-template>
        </p-column>
        <p-column [style]="{'width':'128px'}" [editable]="false" field="datacria" header="DATA">
          <ng-template let-col let-car="rowData" pTemplate="body">
            <span title="{{car['datacria']}}">{{car['datacria']}}</span>
          </ng-template>
        </p-column>
        <p-column [style]="{'width':'16%'}" [editable]="false" field="utilizador" styleClass="ExcelTable2007tdname"
          header="UTILIZADOR">
          <ng-template let-col let-car="rowData" pTemplate="body">
            <span title="{{car['utilizador']}}">{{car['utilizador']}}</span>
          </ng-template>
        </p-column>
        <p-column [style]="{'width':'125px'}" [editable]="false" field="descricao" header="">
          <ng-template let-car="rowData" let-index="rowIndex" pTemplate="body">
            <button type="button" class="btn btn-default btn-xs" title="Ver Ficheiro"
              (click)="showDialog(car.type, car.src,car.name,car.datatype,car.ficheiro,true,car.id)">
              <i class="glyphicon glyphicon-zoom-in"></i>
            </button>
            <a class="btn btn-primary btn-xs" title="Download"
              (click)="download(car.name,car.src,car.datatype,car.ficheiro)" target="_blank"
              style="padding: 3px 0px 3px 12px; margin: 0;">
              <i class="glyphicon glyphicon-download"></i>
            </a>
            <button style="padding: 3px 0px 3px 12px; margin: 3px 0 3px 0;" type="button" class="btn btn-danger btn-xs"
              [disabled]="!modoedicao" title="Apagar" (click)="removerficheiroAnexo(index)">
              <span class="glyphicon glyphicon-trash"></span>
            </button>
          </ng-template>
        </p-column>
      </p-dataTable>
    </div>
  </div>
</p-dialog>


<p-dialog header="Periodicidade" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayperiodicidade"
  [modal]="true">
  <form (keydown.enter)="$event.preventDefault()" #form id="formReclama" (ngSubmit)="atualizarperiodicidade()"
    ngNativeValidate>
    <div style="display: inline-block; width: 100%;">

      <div class="container col-md-6" style="padding: 0;">
        <div class="panel panel-default" style="margin: 0;">
          <div class="panel-heading">Intervalo da Repetição</div>
          <div class="panel-body" style="min-height: 135px;">
            <div class="form-group col-md-6">
              <label style="width: 70px;" for="assunto">Data início:</label>
              <p-calendar [style]="{'width':'120px','padding':'0px 5px'}" dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd"
                [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2050" [(ngModel)]="data_INICIO"
                appendTo="body" [ngModelOptions]="{standalone: true}" [showIcon]="true" [disabled]="!modoedicao"
                required="true">
              </p-calendar>
              <br>
              <!--label style="width: 75px; margin-top: 15px;" for="assunto">Hora:</label>
              <input [disabled]="!modoedicao" style="width:80px; padding: 5px 4px;" [(ngModel)]="hora_INICIO"
                [ngModelOptions]="{standalone: true}" type="time"
                class="ng-tns-c9-3 ui-inputtext ui-widget ui-state-default ui-corner-all"
                ng-reflect-ng-class="ui-inputtext ui-widget ui-stat" required="true" placeholder="hh:mm"-->
            </div>
            <div class="form-group col-md-6">
              <p-radioButton [disabled]="!modoedicao" value="1" required="true" label="Sem data de fim"
                [(ngModel)]="tipo_FIM" [ngModelOptions]="{standalone: true}"></p-radioButton>
              <br>
              <p-radioButton [disabled]="!modoedicao" value="2" required="true" label="Termina após:"
                [(ngModel)]="tipo_FIM" [ngModelOptions]="{standalone: true}"></p-radioButton>
              <input type="text"
                style="background: white;width: 10%; height: 31px; border: 1px solid #e5e5e5; text-align: center; display: initial;"
                class="form-control" [(ngModel)]="ocorrencias" [ngModelOptions]="{standalone: true}"
                [disabled]="!modoedicao" id="ocrr" [required]="tipo_FIM == 2 ? true : null ">
              <label for="ocrr">ocorrências</label>
              <br>
              <p-radioButton [disabled]="!modoedicao" value="3" required="true" label="Data fim:" [(ngModel)]="tipo_FIM"
                [ngModelOptions]="{standalone: true}"></p-radioButton>
              <p-calendar [style]="{'width':'120px','padding':'0px 5px'}" dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd"
                [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2050" [(ngModel)]="data_FINAL"
                [ngModelOptions]="{standalone: true}" [showIcon]="true" [required]="tipo_FIM == 3 ? true : null "
                [disabled]="!modoedicao" appendTo="body">
              </p-calendar>
            </div>
            <div *ngIf="!novo" class="form-group col-md-12" style="font-size: 12px; padding: 0;">
              <b>Número Ocorrências:</b> {{total_OCORRENCIAS}}
              <b style="margin-left: 15px;">Data Última Ocorrência: </b>{{data_ULTIMA_REALIZADA}}
              <b style="margin-left: 15px;">Data Próxima Ocorrência: </b> {{data_PROXIMA_REALIZADA}}
            </div>
          </div>
        </div>
      </div>

      <div class="container col-md-6" style="padding: 0;">
        <div class="panel panel-default" style="margin: 0;">
          <div class="panel-heading"> Padrão de Repetição</div>
          <div class="panel-body" style="min-height: 135px;">
            <div class="form-group col-md-4" style="border-right: 1px solid #e2e2e2; height: 133px;">
              <!--<p-radioButton [disabled]="!modoedicao" value="val0" [(ngModel)]="tipo_REPETICAO" label="Uma vez" [ngModelOptions]="{standalone: true}"></p-radioButton>
                          <br>-->
              <p-radioButton [disabled]="!modoedicao" value="1" required="true" [(ngModel)]="tipo_REPETICAO"
                label="Diário" [ngModelOptions]="{standalone: true}"></p-radioButton>
              <br>
              <p-radioButton [disabled]="!modoedicao" value="2" required="true" [(ngModel)]="tipo_REPETICAO"
                label="Semanal" [ngModelOptions]="{standalone: true}"></p-radioButton>
              <br>
              <p-radioButton [disabled]="!modoedicao" value="3" required="true" [(ngModel)]="tipo_REPETICAO"
                label="Mensal" [ngModelOptions]="{standalone: true}"></p-radioButton>
              <br>
              <p-radioButton [disabled]="!modoedicao" value="4" required="true" [(ngModel)]="tipo_REPETICAO"
                label="Anual" [ngModelOptions]="{standalone: true}"></p-radioButton>
            </div>
            <div class="form-group col-md-8">
              <div class="col-md-12" style="padding-bottom: 0;">
                <label for="rptir">Repetir a cada</label>
                <input id="rptir" type="text"
                  style="background: white;width: 10%; height: 31px; border: 1px solid #e5e5e5; text-align: center; display: initial;"
                  class="form-control" [(ngModel)]="repetir" [ngModelOptions]="{standalone: true}"
                  [disabled]="!modoedicao" required>
                <label *ngIf="tipo_REPETICAO == '1'">dias</label>
                <label *ngIf="tipo_REPETICAO == '2'">semanas</label>
                <label *ngIf="tipo_REPETICAO == '3'">meses</label>
                <label *ngIf="tipo_REPETICAO == '4'">anos</label>
              </div>
              <div class="col-md-12" *ngIf="tipo_REPETICAO == '2'">
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="1" [(ngModel)]="dias_SEMANA" label="Segunda"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="2" [(ngModel)]="dias_SEMANA" label="Terça"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="3" [(ngModel)]="dias_SEMANA" label="Quarta"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="4" [(ngModel)]="dias_SEMANA" label="Quinta"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="5" [(ngModel)]="dias_SEMANA" label="Sexta"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="6" [(ngModel)]="dias_SEMANA" label="Sábado"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
                <div class="col-md-3" style="padding: 0;">
                  <p-checkbox [disabled]="!modoedicao" value="7" [(ngModel)]="dias_SEMANA" label="Domingo"
                    [ngModelOptions]="{standalone: true}"></p-checkbox>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div style="width: 100%; text-align: right;">
        <button type="button" class="btn btn-default" (click)="displayperiodicidade = false">Fechar</button>
        <button [hidden]="!modoedicao" type="submit" class="btn btn-success ">Gravar</button>
      </div>
    </div>
  </form>
</p-dialog>

<button type="button" [hidden]="true" #waitingDialog class="btn btn-primary"
  onclick="waitingDialog.show('A Duplicar Registo', {dialogSize: 'md'});"></button>
<button type="button" [hidden]="true" #waitingDialogclose class="btn btn-primary"
  onclick="waitingDialog.hide();"></button>


<p-dialog header="Duplicar Registo" [responsive]="true" [positionTop]="0"
  [style]="{'max-height':'99vh','width': '100%'}" [dismissableMask]="true" appendTo="body" [closeOnEscape]="true"
  [draggable]="false" [(visible)]="display_duplica" [modal]="true">

  <!-- Modal Header -->

  <form role="form" ngNativeValidate (ngSubmit)="duplica()">
    <!-- Modal Body -->
    <div class="">
      <div class="form-group">
        <label for="descricao">Novo Nome</label><br>
        <input style="width: 500px;" autocomplete="off" type="text" class="form-control2" id="novo_nome"
          [(ngModel)]="novo_nome" [ngModelOptions]="{standalone: true}" placeholder="Nome" required />
      </div>
    </div>
    <!-- Modal Footer -->
    <div class="" style="text-align: right;">
      <button type="button" class="btn btn-default" (click)="display_duplica = false">Fechar</button>
      <button type="submit" class="btn btn-success ">Gravar</button>
    </div>
  </form>

</p-dialog>




<p-dialog header="Localização/Stock" [responsive]="true" [positionTop]="0"
  [style]="{'max-height':'99vh','width': '100%'}" [dismissableMask]="true" appendTo="body" [closeOnEscape]="true"
  [draggable]="false" [(visible)]="displaylocalizacaostock" [modal]="true">

  <!-- Modal Header -->
  <!-- Modal Body -->
  <div class="">
    <p-dataTable class="tabelahometarefa2" [style]="{'min-height':'100px'}" [value]="stocklocalizacoes" dataKey="id">
      <p-column field="Referencia" header="Referência"></p-column>
      <p-column field="Armazem" header="Armazém"></p-column>
      <p-column [style]="{'width':'200px'}" field="stock" header="Stock">
        <ng-template let-col let-car="rowData" pTemplate="body">
          <span>{{car['stock'] | number: '1.0-0' }}</span>
        </ng-template>
      </p-column>
    </p-dataTable>

  </div>
  <!-- Modal Footer -->
  <div class="" style="text-align: -webkit-center;">
    <button type="button" class="btn btn-default" (click)="displaylocalizacaostock = false">Fechar</button>
  </div>
</p-dialog>

<p-dialog header="Aviso" [responsive]="true" [positionTop]="0" [style]="{'max-height':'99vh'}" [width]="500"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayverificar"
  [modal]="true" styleClass="dialog_index2">
  <form role="form">
    <!-- Modal Body -->
    <div style="padding: 0px 50px 0px 50px">
      <span [innerHTML]="mensagem_verifica" style="font-size: 17px;"></span>
    </div>
    <!-- Modal Footer -->
    <div class="" style="text-align: -webkit-center;">
      <button type="button" class="btn btn-default" (click)="displayverificar = false">Fechar</button>

    </div>
  </form>
</p-dialog>
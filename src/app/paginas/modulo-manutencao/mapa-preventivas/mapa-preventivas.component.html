<app-controlos></app-controlos>
<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header" style="height: 40px; padding-top: 16px;" data-background-color="red">
            <h4 style="position: absolute;" class="title">Mapa Preventivas</h4>
            <a style="cursor: pointer; position: absolute;right: 102px; top: -11px; color: black;" title="Exportar"
              (click)="imprimir('xlsx','mapa_preventivas')">
              <i class="material-icons">print</i>
            </a>

            <a style=" position: absolute;right: 185px; top: -9px; color: black; " *ngIf="loadingFile">
              <span>A Transferir...</span>
            </a>
          </div>
          <div class="card-content">
            <form (keydown.enter)="$event.preventDefault()" #form id="formReclama" ngNativeValidate>
              <div class="container-fluid" style="padding: 0;">


                <div style="display: inline-block; width: 100%;">

                  <div style="padding: 1px 5px 1px 0;" class="form-group col-md-12">
                    <div style="padding: 1px 5px 1px 10px; width: 7%;" class="form-group col-md-2 ">
                      <label>Ano</label><br>
                      <p-dropdown [options]="anos" class="droplinha"
                        [style]="{'width':'100%','min-width': '75px','height':'25px'}" [(ngModel)]="ano"
                        [ngModelOptions]="{standalone: true}">
                      </p-dropdown>
                    </div>

                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                      <label>Âmbito Manutenção</label>
                      <p-dropdown [options]="drop_ambitos_manutencao" [filter]="true"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="AMBITO_MANUTENCAO"
                        [ngModelOptions]="{standalone: true}"></p-dropdown>
                    </div>
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                      <label>Localização</label>
                      <p-dropdown [options]="drop_localizacoes" [filter]="true"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="localizacao"
                        [ngModelOptions]="{standalone: true}"></p-dropdown>
                    </div>
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                      <label>Equipamento</label>
                      <p-dropdown [options]="drop_equipamentos" [filter]="true"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="equipamento"
                        [ngModelOptions]="{standalone: true}"></p-dropdown>
                    </div>
                    <div class="table-row-column col-md-3"
                      style="padding-left: 0; width: 17%; padding-top: 26px; min-width: 253px;">
                      <p-checkbox [(ngModel)]="ver_atrasos" [ngModelOptions]="{standalone: true}"
                        label="Ver Atrasos na Data de Conclusão" binary="true">
                      </p-checkbox>
                    </div>
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-3 col-lg-3">
                      <label>Departamento Criticidade</label>
                      <p-dropdown [options]="departs" [filter]="true" (onChange)="atualizaniveis($event)"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="departamento"
                        [ngModelOptions]="{standalone: true}"></p-dropdown>
                    </div>
                    <div style="padding: 1px 5px 1px 10px;" class="form-group col-md-2 col-lg-32">
                      <label>Níveis de Criticidade</label>
                      <p-dropdown [options]="drop_niveis" [filter]="true"
                        [style]="{'width':'100%','height':'25px','background':'white'}" [(ngModel)]="nivel"
                        [ngModelOptions]="{standalone: true}"></p-dropdown>
                    </div>

                    <div class="col-md-1" style="padding: 1px 5px 1px 10px; ">
                      <label>Semanas</label>
                      <p-multiSelect [(ngModel)]="semanas" [ngModelOptions]="{standalone: true}"
                        [options]="numerosemanas" [style]="{'width':'100%','height':'25px','padding':'3px 0px 0px 7px'}"
                        styleClass="ui-column-filter"></p-multiSelect>
                    </div>
                    <div class="col-md-3" style="padding: 1px 5px 1px 10px; ">
                      <label>Data Entre</label><br>
                      <p-calendar [style]="{'height':'25px','width':'122px','margin-right': '44px'}"
                        dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                        yearRange="2000:2050" [(ngModel)]="DATA_INCIO" [ngModelOptions]="{standalone: true}"
                        [showIcon]="true" [required]="true"></p-calendar>
                      e
                      <p-calendar [style]="{'height':'25px','width':'122px','margin-left': '21px'}"
                        dateFormat="yy-mm-dd" placeholder="yyyy-mm-dd" [monthNavigator]="true" [yearNavigator]="true"
                        yearRange="2000:2050" [(ngModel)]="DATA_FIM" [ngModelOptions]="{standalone: true}"
                        [showIcon]="true" [required]="true"></p-calendar>
                    </div>

                    <div class="table-row-column col-md-3" style="text-align: right;">
                      <br>
                      <button type="button" (click)="carregaAnalise()" class="btn btn-success " [disabled]="loading"
                        style="margin: -2px 0 0 0px; height: 27px; padding: 0px 10px 0 10px;">Aplicar</button>
                      <button type="button" (click)="limpar()" class="btn btn-danger " [disabled]="loading"
                        style="margin: -2px 0 0 15px; height: 27px; padding: 0px 10px 0 10px;">Limpar</button>
                    </div>

                  </div>


                  <div style="padding: 1px 5px 1px 0; overflow-y: auto;" class="form-group col-md-12 tabeladiv">
                    <table class="tg">
                      <thead>
                        <tr>
                          <th class="tg-wflh">Equipment</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(1)" *ngIf="week1_show">Week 1</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(2)" *ngIf="week2_show">Week 2</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(3)" *ngIf="week3_show">Week 3</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(4)" *ngIf="week4_show">Week 4</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(5)" *ngIf="week5_show">Week 5</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(6)" *ngIf="week6_show">Week 6</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(7)" *ngIf="week7_show">Week 7</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(8)" *ngIf="week8_show">Week 8</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(9)" *ngIf="week9_show">Week 9</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(10)" *ngIf="week10_show">Week 10</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(11)" *ngIf="week11_show">Week 11</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(12)" *ngIf="week12_show">Week 12</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(13)" *ngIf="week13_show">Week 13</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(14)" *ngIf="week14_show">Week 14</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(15)" *ngIf="week15_show">Week 15</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(16)" *ngIf="week16_show">Week 16</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(17)" *ngIf="week17_show">Week 17</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(18)" *ngIf="week18_show">Week 18</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(19)" *ngIf="week19_show">Week 19</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(20)" *ngIf="week20_show">Week 20</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(21)" *ngIf="week21_show">Week 21</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(22)" *ngIf="week22_show">Week 22</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(23)" *ngIf="week23_show">Week 23</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(24)" *ngIf="week24_show">Week 24</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(25)" *ngIf="week25_show">Week 25</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(26)" *ngIf="week26_show">Week 26</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(27)" *ngIf="week27_show">Week 27</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(28)" *ngIf="week28_show">Week 28</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(29)" *ngIf="week29_show">Week 29</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(30)" *ngIf="week30_show">Week 30</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(31)" *ngIf="week31_show">Week 31</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(32)" *ngIf="week32_show">Week 32</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(33)" *ngIf="week33_show">Week 33</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(34)" *ngIf="week34_show">Week 34</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(35)" *ngIf="week35_show">Week 35</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(36)" *ngIf="week36_show">Week 36</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(37)" *ngIf="week37_show">Week 37</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(38)" *ngIf="week38_show">Week 38</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(39)" *ngIf="week39_show">Week 39</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(40)" *ngIf="week40_show">Week 40</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(41)" *ngIf="week41_show">Week 41</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(42)" *ngIf="week42_show">Week 42</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(43)" *ngIf="week43_show">Week 43</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(44)" *ngIf="week44_show">Week 44</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(45)" *ngIf="week45_show">Week 45</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(46)" *ngIf="week46_show">Week 46</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(47)" *ngIf="week47_show">Week 47</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(48)" *ngIf="week48_show">Week 48</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(49)" *ngIf="week49_show">Week 49</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(50)" *ngIf="week50_show">Week 50</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(51)" *ngIf="week51_show">Week 51</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(52)" *ngIf="week52_show">Week 52</th>
                          <th class="tg-wflh" style="cursor: pointer;" (click)="clicaSemana(53)" *ngIf="week53_show">Week 53</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let col of dados">
                          <th class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <b style="cursor: pointer;"
                              (click)="verEquipamento(col.id_equipamento)">{{col.equipamento}}</b><br>
                            <span
                              style="font-size: 10px; font-size: 9px; display: block; margin-top: -7px;">({{col.localizacao}})</span>
                          </th>
                          <td *ngIf="week1_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week1">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week2_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week2">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week3_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week3">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week4_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week4">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week5_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week5">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week6_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week6">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week7_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week7">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week8_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week8">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week9_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week9">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week10_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week10">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week11_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week11">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week12_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week12">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week13_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week13">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week14_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week14">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week15_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week15">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week16_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week16">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week17_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week17">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week18_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week18">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week19_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week19">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week20_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week20">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week21_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week21">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week22_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week22">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week23_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week23">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week24_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week24">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week25_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week25">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week26_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week26">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week27_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week27">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week28_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week28">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week29_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week29">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week30_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week30">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week31_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week31">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week32_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week32">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week33_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week33">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week34_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week34">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week35_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week35">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week36_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week36">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week37_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week37">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week38_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week38">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week39_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week39">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week40_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week40">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week41_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week41">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week42_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week42">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week43_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week43">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week44_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week44">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week45_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week45">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week46_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week46">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week47_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week47">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week48_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week48">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week49_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week49">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week50_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week50">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week51_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week51">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week52_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week52">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                          <td *ngIf="week53_show" class="tg-0pky" style="min-width: 120px; max-width: none; background-color: #D9D9D9;">
                            <div *ngFor="let val of col.week53">
                              <div (click)="verManutencao(val.id)" title="{{val.title}}" class="cor_{{val.class}}">
                                {{val.valor}}</div>
                            </div>
                          </td>
                        </tr>
                        <tr *ngIf="dados.length == 0 && loading == false">
                          <td class="tg-0pky" style="margin-left: 300px;" colspan="54">{{mensagemtabela}}</td>
                        </tr>
                        <tr *ngIf="loading">
                          <td class="tg-0pky" style="margin-left: 300px;" colspan="54">A Carregar..</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div style="padding: 1px 5px 1px 0;" class="form-group col-md-12">
                    <ul class="bar-legend">
                      <li><span style="font-weight: bold;">D </span>- Diário </li>
                      <li><span style="font-weight: bold;">W </span>- Semanal </li>
                      <li><span style="font-weight: bold;">M </span>- Mensal </li>
                      <li><span style="font-weight: bold;">B </span>- Bimestral </li>
                      <li><span style="font-weight: bold;">T </span>- Trimestral </li>
                      <li><span style="font-weight: bold;">Q </span>- Quadrimestral </li>
                      <li><span style="font-weight: bold;">S </span>- Semestral </li>
                      <li><span style="font-weight: bold;">A </span>- Anual </li>
                      <li><span style="font-weight: bold;">Número </span>- Id da Manutenção </li>
                    </ul>
                    <ul class="bar-legend">
                      <li><span class="bar-legend-pointer cor_red"></span>- Manutenções Planeadas em Atraso. </li>
                      <li><span class="bar-legend-pointer cor_green"></span>- Manutenções Planeadas dentro do Prazo.
                      </li>
                      <li><span class="bar-legend-pointer cor_red cor_red_t"></span>- Manutenções Concluídas mas Fora da
                        Data Prevista. </li>
                      <li><span class="bar-legend-pointer cor_green cor_green_t"></span>- Conclusão das Manutenções Fora
                        da Data Prevista. </li>
                    </ul>
                  </div>

                </div>



              </div>


              <div class="clearfix"> </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<p-dialog header="Manutenção" [responsive]="true" [positionTop]="0" [style]="{'height':'99vh','width': '100vw'}"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayManutencao"
  (onHide)="onHide()" [modal]="true">

  <!-- Modal Header -->

  <!-- Modal Body -->
  <div class="" style="width: 95vw; max-height: 81vh; overflow: auto;">
    <!--app-pedidos-melhoria-manutencao class="cssapp-paginatarefa" *ngIf="CLASSIFICACAO == 'M'"
      [ID_PEDIDO_INPUT_2]="ID_PEDIDO_INPUT">
    </app-pedidos-melhoria-manutencao>

    <app-ficha-manutencao class="cssapp-paginatarefa" *ngIf="CLASSIFICACAO == 'C'" [ID_PEDIDO_INPUT]="ID_PEDIDO_INPUT">
    </app-ficha-manutencao-->

    <app-manutencoes-preventivas class="cssapp-paginatarefa"
      *ngIf="(CLASSIFICACAO == 'P' || CLASSIFICACAO == 'MM') && ID_PEDIDO_INPUT != null"
      [ID_PEDIDO_INPUT]="ID_PEDIDO_INPUT">
    </app-manutencoes-preventivas>
  </div>
  <!-- Modal Footer -->
  <div class="" style="text-align: -webkit-center;">
    <button type="button" class="btn btn-default" style="margin: 0;"
      (click)="displayManutencao = false;">Fechar</button>
  </div>

</p-dialog>



<p-dialog header="Equipamento" [responsive]="true" [positionTop]="0" [style]="{'height':'99vh','width': '100vw'}"
  [dismissableMask]="true" appendTo="body" [closeOnEscape]="true" [draggable]="false" [(visible)]="displayEquipamento"
  (onHide)="onHideEquipamentos()" [modal]="true">

  <!-- Modal Header -->

  <!-- Modal Body -->
  <div class="" style="width: 95vw; max-height: 81vh; overflow: auto;">

    <app-ficha-equipamento class="cssapp-paginatarefa" [ID_EQUIPAMENTO_INPUT]="ID_EQUIPAMENTO_INPUT"
      *ngIf="ID_EQUIPAMENTO_INPUT != null">
    </app-ficha-equipamento>
  </div>
  <!-- Modal Footer -->
  <div class="" style="text-align: -webkit-center;">
    <button type="button" class="btn btn-default" style="margin: 0;"
      (click)="displayEquipamento = false;">Fechar</button>
  </div>

</p-dialog>
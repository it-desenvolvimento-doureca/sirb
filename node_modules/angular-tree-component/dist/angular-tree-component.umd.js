!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("mobx-angular"),require("lodash"),require("mobx")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","mobx-angular","lodash","mobx"],t):t(e["angular-tree-component"]=e["angular-tree-component"]||{},e._angular_core,e._angular_common,e.mobxAngular,e._,e.mobx)}(this,function(e,t,n,o,r,i){"use strict";function s(){return Math.floor(1e13*Math.random())}function d(e,t,n){void 0===n&&(n=0);for(var o=n,r=e.length-1;o!==r;){var i=Math.floor((o+r)/2);t(e[i])?r=i:o=o===i?r:i}return o}var p,a={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,SPACE:32},l={TOGGLE_SELECTED:function(e,t,n){return t&&t.toggleActivated()},TOGGLE_SELECTED_MULTI:function(e,t,n){return t&&t.toggleActivated(!0)},SELECT:function(e,t,n){return t.setIsActive(!0)},DESELECT:function(e,t,n){return t.setIsActive(!1)},FOCUS:function(e,t,n){return t.focus()},TOGGLE_EXPANDED:function(e,t,n){return t.hasChildren&&t.toggleExpanded()},EXPAND:function(e,t,n){return t.expand()},COLLAPSE:function(e,t,n){return t.collapse()},DRILL_DOWN:function(e,t,n){return e.focusDrillDown()},DRILL_UP:function(e,t,n){return e.focusDrillUp()},NEXT_NODE:function(e,t,n){return e.focusNextNode()},PREVIOUS_NODE:function(e,t,n){return e.focusPreviousNode()},MOVE_NODE:function(e,t,n,o){var r=o.from,i=o.to;n.ctrlKey?e.copyNode(r,i):e.moveNode(r,i)}},c={mouse:{click:l.TOGGLE_SELECTED,dblClick:null,contextMenu:null,expanderClick:l.TOGGLE_EXPANDED,drop:l.MOVE_NODE},keys:(p={},p[a.RIGHT]=l.DRILL_DOWN,p[a.LEFT]=l.DRILL_UP,p[a.DOWN]=l.NEXT_NODE,p[a.UP]=l.PREVIOUS_NODE,p[a.SPACE]=l.TOGGLE_SELECTED,p[a.ENTER]=l.TOGGLE_SELECTED,p)},u=function(){function e(e){void 0===e&&(e={}),this.options=e,this.actionMapping=r.defaultsDeep({},this.options.actionMapping,c),e.rtl&&(this.actionMapping.keys[a.RIGHT]=r.get(e,["actionMapping","keys",a.RIGHT])||l.DRILL_UP,this.actionMapping.keys[a.LEFT]=r.get(e,["actionMapping","keys",a.LEFT])||l.DRILL_DOWN)}return Object.defineProperty(e.prototype,"childrenField",{get:function(){return this.options.childrenField||"children"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayField",{get:function(){return this.options.displayField||"name"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idField",{get:function(){return this.options.idField||"id"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpandedField",{get:function(){return this.options.isExpandedField||"isExpanded"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getChildren",{get:function(){return this.options.getChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelPadding",{get:function(){return this.options.levelPadding||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useVirtualScroll",{get:function(){return this.options.useVirtualScroll},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animateExpand",{get:function(){return this.options.animateExpand},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animateSpeed",{get:function(){return this.options.animateSpeed||30},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animateAcceleration",{get:function(){return this.options.animateAcceleration||1.2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollOnSelect",{get:function(){return void 0===this.options.scrollOnSelect||this.options.scrollOnSelect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rtl",{get:function(){return!!this.options.rtl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rootId",{get:function(){return this.options.rootId},enumerable:!0,configurable:!0}),e.prototype.getNodeClone=function(e){return this.options.getNodeClone?this.options.getNodeClone(e):r.omit(Object.assign({},e.data),["id"])},e.prototype.allowDrop=function(e,t,n){return this.options.allowDrop instanceof Function?this.options.allowDrop(e,t,n):void 0===this.options.allowDrop||this.options.allowDrop},e.prototype.allowDrag=function(e){return this.options.allowDrag instanceof Function?this.options.allowDrag(e):this.options.allowDrag},e.prototype.nodeClass=function(e){return this.options.nodeClass?this.options.nodeClass(e):""},e.prototype.nodeHeight=function(e){if(e.data.virtual)return 0;var t=this.options.nodeHeight||22;return"function"==typeof t&&(t=t(e)),t+(0===e.index?2:1)*this.dropSlotHeight},Object.defineProperty(e.prototype,"dropSlotHeight",{get:function(){return this.options.dropSlotHeight||2},enumerable:!0,configurable:!0}),e}(),h={toggleExpanded:"toggleExpanded",activate:"activate",deactivate:"deactivate",focus:"focus",blur:"blur",initialized:"initialized",updateData:"updateData",moveNode:"moveNode",copyNode:"copyNode",event:"event",loadNodeChildren:"loadNodeChildren",changeFilter:"changeFilter",stateChange:"stateChange"},f=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var d=e.length-1;d>=0;d--)(r=e[d])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=r.first,v=r.last,m=function(){function e(e,t,n,o){var r=this;this.data=e,this.parent=t,this.treeModel=n,this.position=0,this.allowDrop=function(e,t){return r.options.allowDrop(e,{parent:r,index:0},t)},void 0!==this.id&&null!==this.id||(this.id=s()),this.index=o,this.getField("children")&&this._initChildren()}return Object.defineProperty(e.prototype,"isHidden",{get:function(){return this.treeModel.isHidden(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpanded",{get:function(){return this.treeModel.isExpanded(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return this.treeModel.isActive(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFocused",{get:function(){return this.treeModel.isNodeFocused(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.parent?this.parent.level+1:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.parent?this.parent.path.concat([this.id]):[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementRef",{get:function(){throw"Element Ref is no longer supported since introducing virtual scroll\n\n      You may use a template to obtain a reference to the element"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalNode",{get:function(){return this._originalNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasChildren",{get:function(){return!!(this.data.hasChildren||this.children&&this.children.length>0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCollapsed",{get:function(){return!this.isExpanded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLeaf",{get:function(){return!this.hasChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRoot",{get:function(){return this.parent.data.virtual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realParent",{get:function(){return this.isRoot?null:this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.treeModel.options},enumerable:!0,configurable:!0}),e.prototype.fireEvent=function(e){this.treeModel.fireEvent(e)},Object.defineProperty(e.prototype,"displayField",{get:function(){return this.getField("display")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.getField("id")},set:function(e){this.setField("id",e)},enumerable:!0,configurable:!0}),e.prototype.getField=function(e){return this.data[this.options[e+"Field"]]},e.prototype.setField=function(e,t){this.data[this.options[e+"Field"]]=t},e.prototype._findAdjacentSibling=function(e,t){return void 0===t&&(t=!1),this._getParentsChildren(t)[this.index+e]},e.prototype.findNextSibling=function(e){return void 0===e&&(e=!1),this._findAdjacentSibling(1,e)},e.prototype.findPreviousSibling=function(e){return void 0===e&&(e=!1),this._findAdjacentSibling(-1,e)},e.prototype.getVisibleChildren=function(){return this.visibleChildren},Object.defineProperty(e.prototype,"visibleChildren",{get:function(){return(this.children||[]).filter(function(e){return!e.isHidden})},enumerable:!0,configurable:!0}),e.prototype.getFirstChild=function(e){void 0===e&&(e=!1);var t=e?this.visibleChildren:this.children;return y(t||[])},e.prototype.getLastChild=function(e){void 0===e&&(e=!1);var t=e?this.visibleChildren:this.children;return v(t||[])},e.prototype.findNextNode=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!1),e&&this.isExpanded&&this.getFirstChild(t)||this.findNextSibling(t)||this.parent&&this.parent.findNextNode(!1,t)},e.prototype.findPreviousNode=function(e){void 0===e&&(e=!1);var t=this.findPreviousSibling(e);return t?t._getLastOpenDescendant(e):this.realParent},e.prototype._getLastOpenDescendant=function(e){void 0===e&&(e=!1);var t=this.getLastChild(e);return this.isCollapsed||!t?this:t._getLastOpenDescendant(e)},e.prototype._getParentsChildren=function(e){return void 0===e&&(e=!1),this.parent&&(e?this.parent.getVisibleChildren():this.parent.children)||[]},e.prototype.getIndexInParent=function(e){return void 0===e&&(e=!1),this._getParentsChildren(e).indexOf(this)},e.prototype.isDescendantOf=function(e){return this===e||this.parent&&this.parent.isDescendantOf(e)},e.prototype.getNodePadding=function(){return this.options.levelPadding*(this.level-1)+"px"},e.prototype.getClass=function(){return[this.options.nodeClass(this),"tree-node-level-"+this.level].join(" ")},e.prototype.onDrop=function(e){this.mouseAction("drop",e.event,{from:e.element,to:{parent:this,index:0,dropOnNode:!0}})},e.prototype.allowDrag=function(){return this.options.allowDrag(this)},e.prototype.loadNodeChildren=function(){var e=this;return this.options.getChildren?Promise.resolve(this.options.getChildren(this)).then(function(t){t&&(e.setField("children",t),e._initChildren(),e.children.forEach(function(e){e.getField("isExpanded")&&e.hasChildren&&e.expand()}))}).then(function(){e.fireEvent({eventName:h.loadNodeChildren,node:e})}):Promise.resolve()},e.prototype.expand=function(){return this.isExpanded?Promise.resolve():this.toggleExpanded()},e.prototype.collapse=function(){return this.isExpanded&&this.toggleExpanded(),this},e.prototype.doForAll=function(e){var t=this;Promise.resolve(e(this)).then(function(){t.children&&t.children.forEach(function(t){return t.doForAll(e)})})},e.prototype.expandAll=function(){this.doForAll(function(e){return e.expand()})},e.prototype.collapseAll=function(){this.doForAll(function(e){return e.collapse()})},e.prototype.ensureVisible=function(){return this.realParent&&(this.realParent.expand(),this.realParent.ensureVisible()),this},e.prototype.toggleExpanded=function(){return this.setIsExpanded(!this.isExpanded)},e.prototype.setIsExpanded=function(e){return this.hasChildren&&(this.treeModel.setExpandedNode(this,e),!this.children&&this.hasChildren&&e)?this.loadNodeChildren():Promise.resolve()},e.prototype.setIsActive=function(e,t){return void 0===t&&(t=!1),this.treeModel.setActiveNode(this,e,t),e&&this.focus(this.options.scrollOnSelect),this},e.prototype.toggleActivated=function(e){return void 0===e&&(e=!1),this.setIsActive(!this.isActive,e),this},e.prototype.setActiveAndVisible=function(e){return void 0===e&&(e=!1),this.setIsActive(!0,e).ensureVisible(),setTimeout(this.scrollIntoView.bind(this)),this},e.prototype.scrollIntoView=function(e){void 0===e&&(e=!1),this.treeModel.virtualScroll.scrollIntoView(this,e)},e.prototype.focus=function(e){void 0===e&&(e=!0);var t=this.treeModel.getFocusedNode();return this.treeModel.setFocusedNode(this),e&&this.scrollIntoView(),t&&this.fireEvent({eventName:h.blur,node:t}),this.fireEvent({eventName:h.focus,node:this}),this},e.prototype.blur=function(){var e=this.treeModel.getFocusedNode();return this.treeModel.setFocusedNode(null),e&&this.fireEvent({eventName:h.blur,node:this}),this},e.prototype.setIsHidden=function(e){this.treeModel.setIsHidden(this,e)},e.prototype.hide=function(){this.setIsHidden(!0)},e.prototype.show=function(){this.setIsHidden(!1)},e.prototype.mouseAction=function(e,t,n){void 0===n&&(n=null),this.treeModel.setFocus(!0);var o=this.options.actionMapping.mouse,r=o[e];r&&r(this.treeModel,this,t,n)},e.prototype.getSelfHeight=function(){return this.options.nodeHeight(this)},e.prototype._initChildren=function(){var t=this;this.children=this.getField("children").map(function(n,o){return new e(n,t,t.treeModel,o)})},e}();f([i.computed,g("design:type",Object),g("design:paramtypes",[])],m.prototype,"isHidden",null),f([i.computed,g("design:type",Object),g("design:paramtypes",[])],m.prototype,"isExpanded",null),f([i.computed,g("design:type",Object),g("design:paramtypes",[])],m.prototype,"isActive",null),f([i.computed,g("design:type",Object),g("design:paramtypes",[])],m.prototype,"isFocused",null),f([i.observable,g("design:type",Array)],m.prototype,"children",void 0),f([i.observable,g("design:type",Number)],m.prototype,"index",void 0),f([i.observable,g("design:type",Object)],m.prototype,"position",void 0),f([i.observable,g("design:type",Number)],m.prototype,"height",void 0),f([i.computed,g("design:type",Number),g("design:paramtypes",[])],m.prototype,"level",null),f([i.computed,g("design:type",Array),g("design:paramtypes",[])],m.prototype,"path",null),f([i.computed,g("design:type",Object),g("design:paramtypes",[])],m.prototype,"visibleChildren",null),f([i.action,g("design:type",Function),g("design:paramtypes",[]),g("design:returntype",void 0)],m.prototype,"_initChildren",null);var b=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var d=e.length-1;d>=0;d--)(r=e[d])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},N=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},E=r.first,O=r.last,D=r.compact,x=r.find,I=r.isString,C=r.isFunction,w=function(){function e(){this.options=new u,this.eventNames=Object.keys(h),this.expandedNodeIds={},this.activeNodeIds={},this.hiddenNodeIds={},this.focusedNodeId=null,this.firstUpdate=!0}return e.prototype.fireEvent=function(e){e.treeModel=this,this.events[e.eventName].emit(e),this.events.event.emit(e)},e.prototype.subscribe=function(e,t){this.events[e].subscribe(t)},e.prototype.getFocusedNode=function(){return this.focusedNode},e.prototype.getActiveNode=function(){return this.activeNodes[0]},e.prototype.getActiveNodes=function(){return this.activeNodes},e.prototype.getVisibleRoots=function(){return this.virtualRoot.visibleChildren},e.prototype.getFirstRoot=function(e){return void 0===e&&(e=!1),E(e?this.getVisibleRoots():this.roots)},e.prototype.getLastRoot=function(e){return void 0===e&&(e=!1),O(e?this.getVisibleRoots():this.roots)},Object.defineProperty(e.prototype,"isFocused",{get:function(){return e.focusedTree===this},enumerable:!0,configurable:!0}),e.prototype.isNodeFocused=function(e){return this.focusedNode===e},e.prototype.isEmptyTree=function(){return this.roots&&0===this.roots.length},Object.defineProperty(e.prototype,"focusedNode",{get:function(){return this.focusedNodeId?this.getNodeById(this.focusedNodeId):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expandedNodes",{get:function(){var e=this,t=Object.keys(this.expandedNodeIds).filter(function(t){return e.expandedNodeIds[t]}).map(function(t){return e.getNodeById(t)});return D(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeNodes",{get:function(){var e=this,t=Object.keys(this.activeNodeIds).filter(function(t){return e.activeNodeIds[t]}).map(function(t){return e.getNodeById(t)});return D(t)},enumerable:!0,configurable:!0}),e.prototype.getNodeByPath=function(e,t){if(void 0===t&&(t=null),!e)return null;if(t=t||this.virtualRoot,0===e.length)return t;if(!t.children)return null;var n=e.shift(),o=x(t.children,{id:n});return o?this.getNodeByPath(e,o):null},e.prototype.getNodeById=function(e){var t=e.toString();return this.getNodeBy(function(e){return e.id.toString()===t})},e.prototype.getNodeBy=function(e,t){if(void 0===t&&(t=null),t=t||this.virtualRoot,!t.children)return null;var n=x(t.children,e);if(n)return n;for(var o=0,r=t.children;o<r.length;o++){var i=r[o],s=this.getNodeBy(e,i);if(s)return s}},e.prototype.isExpanded=function(e){return this.expandedNodeIds[e.id]},e.prototype.isHidden=function(e){return this.hiddenNodeIds[e.id]},e.prototype.isActive=function(e){return this.activeNodeIds[e.id]},e.prototype.setData=function(e){var t=e.nodes,n=e.options,o=void 0===n?null:n,r=e.events,i=void 0===r?null:r;o&&(this.options=new u(o)),i&&(this.events=i),t&&(this.nodes=t),this.update()},e.prototype.update=function(){var e=(t={id:this.options.rootId,virtual:!0},t[this.options.childrenField]=this.nodes,t);this.virtualRoot=new m(e,null,this,0),this.roots=this.virtualRoot.children,this.firstUpdate?this.roots&&(this.firstUpdate=!1,this._calculateExpandedNodes()):this.fireEvent({eventName:h.updateData});var t},e.prototype.setFocusedNode=function(e){this.focusedNodeId=e?e.id:null},e.prototype.setFocus=function(t){e.focusedTree=t?this:null},e.prototype.doForAll=function(e){this.roots.forEach(function(t){return t.doForAll(e)})},e.prototype.focusNextNode=function(){var e=this.getFocusedNode(),t=e?e.findNextNode(!0,!0):this.getFirstRoot(!0);t&&t.focus()},e.prototype.focusPreviousNode=function(){var e=this.getFocusedNode(),t=e?e.findPreviousNode(!0):this.getLastRoot(!0);t&&t.focus()},e.prototype.focusDrillDown=function(){var e=this.getFocusedNode();if(e&&e.isCollapsed&&e.hasChildren)e.toggleExpanded();else{var t=e?e.getFirstChild(!0):this.getFirstRoot(!0);t&&t.focus()}},e.prototype.focusDrillUp=function(){var e=this.getFocusedNode();if(e)if(e.isExpanded)e.toggleExpanded();else{var t=e.realParent;t&&t.focus()}},e.prototype.setActiveNode=function(e,t,n){void 0===n&&(n=!1),n?this._setActiveNodeMulti(e,t):this._setActiveNodeSingle(e,t),t?(e.focus(),this.fireEvent({eventName:h.activate,node:e})):this.fireEvent({eventName:h.deactivate,node:e})},e.prototype.setExpandedNode=function(e,t){this.expandedNodeIds=Object.assign({},this.expandedNodeIds,(n={},n[e.id]=t,n)),this.fireEvent({eventName:h.toggleExpanded,node:e,isExpanded:t});var n},e.prototype.expandAll=function(){this.roots.forEach(function(e){return e.expandAll()})},e.prototype.collapseAll=function(){this.roots.forEach(function(e){return e.collapseAll()})},e.prototype.setIsHidden=function(e,t){this.hiddenNodeIds=Object.assign({},this.hiddenNodeIds,(n={},n[e.id]=t,n));var n},e.prototype.setHiddenNodeIds=function(e){this.hiddenNodeIds=e.reduce(function(e,t){return Object.assign(t,(n={},n[e]=!0,n));var n},{})},e.prototype.performKeyAction=function(e,t){var n=this.options.actionMapping.keys[t.keyCode];return!!n&&(t.preventDefault(),n(this,e,t),!0)},e.prototype.filterNodes=function(e,t){var n=this;void 0===t&&(t=!0);var o;if(!e)return this.clearFilter();if(I(e))o=function(t){return-1!==t.displayField.toLowerCase().indexOf(e.toLowerCase())};else{if(!C(e))return console.error("Don't know what to do with filter",e),void console.error("Should be either a string or function");o=e}var r={};this.roots.forEach(function(e){return n._filterNode(r,e,o,t)}),this.hiddenNodeIds=r,this.fireEvent({eventName:h.changeFilter})},e.prototype.clearFilter=function(){this.hiddenNodeIds={},this.fireEvent({eventName:h.changeFilter})},e.prototype.moveNode=function(e,t){var n=e.getIndexInParent(),o=e.parent;if(this._canMoveNode(e,n,t)){var r=o.getField("children");t.parent.getField("children")||t.parent.setField("children",[]);var i=t.parent.getField("children"),s=r.splice(n,1)[0],d=o===t.parent&&t.index>n?t.index-1:t.index;i.splice(d,0,s),o.treeModel.update(),t.parent.treeModel!==o.treeModel&&t.parent.treeModel.update(),this.fireEvent({eventName:h.moveNode,node:s,to:{parent:t.parent.data,index:d}})}},e.prototype.copyNode=function(e,t){var n=e.getIndexInParent();if(this._canMoveNode(e,n,t)){t.parent.getField("children")||t.parent.setField("children",[]);var o=t.parent.getField("children"),r=this.options.getNodeClone(e);o.splice(t.index,0,r),e.treeModel.update(),t.parent.treeModel!==e.treeModel&&t.parent.treeModel.update(),this.fireEvent({eventName:h.copyNode,node:r,to:{parent:t.parent.data,index:t.index}})}},e.prototype.getState=function(){return{expandedNodeIds:this.expandedNodeIds,activeNodeIds:this.activeNodeIds,hiddenNodeIds:this.hiddenNodeIds,focusedNodeId:this.focusedNodeId}},e.prototype.setState=function(e){e&&Object.assign(this,{expandedNodeIds:e.expandedNodeIds||{},activeNodeIds:e.activeNodeIds||{},hiddenNodeIds:e.hiddenNodeIds||{},focusedNodeId:e.focusedNodeId})},e.prototype.subscribeToState=function(e){var t=this;i.autorun(function(){return e(t.getState())})},e.prototype._canMoveNode=function(e,t,n){return(e.parent!==n.parent||t!==n.index)&&!n.parent.isDescendantOf(e)},e.prototype._filterNode=function(e,t,n,o){var r=this,i=n(t);return t.children&&t.children.forEach(function(t){r._filterNode(e,t,n,o)&&(i=!0)}),i||(e[t.id]=!0),o&&i&&t.ensureVisible(),i},e.prototype._calculateExpandedNodes=function(e){var t=this;void 0===e&&(e=null),e=e||this.virtualRoot,e.data[this.options.isExpandedField]&&(this.expandedNodeIds=Object.assign({},this.expandedNodeIds,(n={},n[e.id]=!0,n))),e.children&&e.children.forEach(function(e){return t._calculateExpandedNodes(e)});var n},e.prototype._setActiveNodeSingle=function(e,t){var n=this;this.activeNodes.filter(function(t){return t!==e}).forEach(function(e){n.fireEvent({eventName:h.deactivate,node:e})}),this.activeNodeIds=t?(o={},o[e.id]=!0,o):{};var o},e.prototype._setActiveNodeMulti=function(e,t){this.activeNodeIds=Object.assign({},this.activeNodeIds,(n={},n[e.id]=t,n));var n},e}();w.focusedTree=null,w.decorators=[{type:t.Injectable}],w.ctorParameters=function(){return[]},b([i.observable,N("design:type",Array)],w.prototype,"roots",void 0),b([i.observable,N("design:type",Object)],w.prototype,"expandedNodeIds",void 0),b([i.observable,N("design:type",Object)],w.prototype,"activeNodeIds",void 0),b([i.observable,N("design:type",Object)],w.prototype,"hiddenNodeIds",void 0),b([i.observable,N("design:type",Object)],w.prototype,"focusedNodeId",void 0),b([i.observable,N("design:type",m)],w.prototype,"virtualRoot",void 0),b([i.computed,N("design:type",Object),N("design:paramtypes",[])],w.prototype,"focusedNode",null),b([i.computed,N("design:type",Object),N("design:paramtypes",[])],w.prototype,"expandedNodes",null),b([i.computed,N("design:type",Object),N("design:paramtypes",[])],w.prototype,"activeNodes",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"setData",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"update",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"setFocusedNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"setFocus",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"doForAll",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"focusNextNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"focusPreviousNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"focusDrillDown",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"focusDrillUp",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object,Object]),N("design:returntype",void 0)],w.prototype,"setActiveNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object]),N("design:returntype",void 0)],w.prototype,"setExpandedNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"expandAll",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"collapseAll",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object]),N("design:returntype",void 0)],w.prototype,"setIsHidden",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"setHiddenNodeIds",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object]),N("design:returntype",void 0)],w.prototype,"filterNodes",null),b([i.action,N("design:type",Function),N("design:paramtypes",[]),N("design:returntype",void 0)],w.prototype,"clearFilter",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object]),N("design:returntype",void 0)],w.prototype,"moveNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object,Object]),N("design:returntype",void 0)],w.prototype,"copyNode",null),b([i.action,N("design:type",Function),N("design:paramtypes",[Object]),N("design:returntype",void 0)],w.prototype,"setState",null);var j=function(){function e(){this._draggedElement=null}return e.prototype.set=function(e){this._draggedElement=e},e.prototype.get=function(){return this._draggedElement},e.prototype.isDragging=function(){return!!this.get()},e}();j.decorators=[{type:t.Injectable}],j.ctorParameters=function(){return[]};var P=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var d=e.length-1;d>=0;d--)(r=e[d])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},F=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},A=function(){function e(e){var t=this;this.treeModel=e,this.yBlocks=0,this.x=0,this.viewportHeight=null,this.viewport=null,e.virtualScroll=this,this._dispose=[i.autorun(function(){return t.fixScroll()})]}return Object.defineProperty(e.prototype,"y",{get:function(){return 50*this.yBlocks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalHeight",{get:function(){return this.treeModel.virtualRoot?this.treeModel.virtualRoot.height:0},enumerable:!0,configurable:!0}),e.prototype.fireEvent=function(e){this.treeModel.fireEvent(e)},e.prototype.init=function(){var e=this,t=this.recalcPositions.bind(this);t(),this._dispose=this._dispose.concat([i.reaction(function(){return e.treeModel.roots},t),i.reaction(function(){return e.treeModel.expandedNodeIds},t),i.reaction(function(){return e.treeModel.hiddenNodeIds},t)]),this.treeModel.subscribe(h.loadNodeChildren,t)},e.prototype.isEnabled=function(){return this.treeModel.options.useVirtualScroll},e.prototype._setYBlocks=function(e){this.yBlocks=e},e.prototype.recalcPositions=function(){this.treeModel.virtualRoot.height=this._getPositionAfter(this.treeModel.getVisibleRoots(),0)},e.prototype._getPositionAfter=function(e,t){var n=this,o=t;return e.forEach(function(e){e.position=o,o=n._getPositionAfterNode(e,o)}),o},e.prototype._getPositionAfterNode=function(e,t){var n=e.getSelfHeight()+t;return e.children&&e.isExpanded&&(n=this._getPositionAfter(e.visibleChildren,n)),e.height=n-t,n},e.prototype.clear=function(){this._dispose.forEach(function(e){return e()})},e.prototype.setViewport=function(e){Object.assign(this,{viewport:e,x:e.scrollLeft,yBlocks:Math.round(e.scrollTop/50),viewportHeight:e.getBoundingClientRect().height})},e.prototype.scrollIntoView=function(e,t,n){void 0===n&&(n=!0),(t||e.position<this.y||e.position+e.getSelfHeight()>this.y+this.viewportHeight)&&this.viewport&&(this.viewport.scrollTop=n?e.position-this.viewportHeight/2:e.position,this._setYBlocks(Math.floor(this.viewport.scrollTop/50)))},e.prototype.getViewportNodes=function(e){var t=this;if(!e)return[];var n=e.filter(function(e){return!e.isHidden});if(!this.isEnabled())return n;if(!this.viewportHeight||!n.length)return[];for(var o=d(n,function(e){return e.position+300>t.y||e.position+e.height>t.y}),r=d(n,function(e){return e.position-300>t.y+t.viewportHeight},o),i=[],s=o;s<=r;s++)i.push(n[s]);return i},e.prototype.fixScroll=function(){var e=Math.max(0,this.totalHeight-this.viewportHeight);this.y<0&&this._setYBlocks(0),this.y>e&&this._setYBlocks(e/50)},e}();A.decorators=[{type:t.Injectable}],A.ctorParameters=function(){return[{type:w}]},P([i.observable,F("design:type",Object)],A.prototype,"yBlocks",void 0),P([i.observable,F("design:type",Object)],A.prototype,"x",void 0),P([i.observable,F("design:type",Object)],A.prototype,"viewportHeight",void 0),P([i.computed,F("design:type",Object),F("design:paramtypes",[])],A.prototype,"y",null),P([i.computed,F("design:type",Object),F("design:paramtypes",[])],A.prototype,"totalHeight",null),P([i.action,F("design:type",Function),F("design:paramtypes",[Object]),F("design:returntype",void 0)],A.prototype,"_setYBlocks",null),P([i.action,F("design:type",Function),F("design:paramtypes",[]),F("design:returntype",void 0)],A.prototype,"recalcPositions",null),P([i.action,F("design:type",Function),F("design:paramtypes",[Object]),F("design:returntype",void 0)],A.prototype,"setViewport",null),P([i.action,F("design:type",Function),F("design:paramtypes",[Object,Object,Object]),F("design:returntype",void 0)],A.prototype,"scrollIntoView",null);var M=function(){function e(){}return e}();M.decorators=[{type:t.Component,args:[{encapsulation:t.ViewEncapsulation.None,selector:"tree-loading-component",template:'\n    <span *ngIf="!template">loading...</span>\n    <ng-container\n      [ngTemplateOutlet]="template"\n      [ngOutletContext]="{ $implicit: node }">\n    </ng-container>\n  '}]}],M.ctorParameters=function(){return[]},M.propDecorators={template:[{type:t.Input}],node:[{type:t.Input}]};var T=r.includes,_=r.pick,S=function(){function e(e,n,o){var r=this;this.treeModel=e,this.treeDraggedElement=n,this.renderer=o,e.eventNames.forEach(function(e){return r[e]=new t.EventEmitter}),e.subscribeToState(function(e){return r.stateChange.emit(e)})}return Object.defineProperty(e.prototype,"nodes",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{set:function(e){this.treeModel.setFocus(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{set:function(e){this.treeModel.setState(e)},enumerable:!0,configurable:!0}),e.prototype.onKeydown=function(e){if(this.treeModel.isFocused&&!T(["input","textarea"],document.activeElement.tagName.toLowerCase())){var t=this.treeModel.getFocusedNode();this.treeModel.performKeyAction(t,e)}},e.prototype.onMousedown=function(e){this.renderer.invokeElementMethod(e.target,"closest",["Tree"])||this.treeModel.setFocus(!1)},e.prototype.ngOnChanges=function(e){this.treeModel.setData({options:e.options&&e.options.currentValue,nodes:e.nodes&&e.nodes.currentValue,events:_(this,this.treeModel.eventNames)})},e}();S.decorators=[{type:t.Component,args:[{selector:"Tree, tree-root",providers:[w],styles:[],
template:'\n    <tree-viewport>\n      <div\n        class="angular-tree-component"\n        [class.node-dragging]="treeDraggedElement.isDragging()"\n        [class.angular-tree-component-rtl]="treeModel.options.rtl">\n        <tree-node-collection\n          *ngIf="treeModel.roots"\n          [nodes]="treeModel.roots"\n          [treeModel]="treeModel"\n          [templates]="{\n            loadingTemplate: loadingTemplate,\n            treeNodeTemplate: treeNodeTemplate,\n            treeNodeWrapperTemplate: treeNodeWrapperTemplate,\n            treeNodeFullTemplate: treeNodeFullTemplate\n          }">\n        </tree-node-collection>\n        <tree-node-drop-slot\n          class="empty-tree-drop-slot"\n          *ngIf="treeModel.isEmptyTree()"\n          [dropIndex]="0"\n          [node]="treeModel.virtualRoot">\n        </tree-node-drop-slot>\n      </div>\n    </tree-viewport>\n  '}]}],S.ctorParameters=function(){return[{type:w},{type:j},{type:t.Renderer}]},S.propDecorators={loadingTemplate:[{type:t.ContentChild,args:["loadingTemplate"]}],treeNodeTemplate:[{type:t.ContentChild,args:["treeNodeTemplate"]}],treeNodeWrapperTemplate:[{type:t.ContentChild,args:["treeNodeWrapperTemplate"]}],treeNodeFullTemplate:[{type:t.ContentChild,args:["treeNodeFullTemplate"]}],nodes:[{type:t.Input}],options:[{type:t.Input}],focused:[{type:t.Input}],state:[{type:t.Input}],toggleExpanded:[{type:t.Output}],activate:[{type:t.Output}],deactivate:[{type:t.Output}],focus:[{type:t.Output}],blur:[{type:t.Output}],updateData:[{type:t.Output}],initialized:[{type:t.Output}],moveNode:[{type:t.Output}],copyNode:[{type:t.Output}],loadNodeChildren:[{type:t.Output}],changeFilter:[{type:t.Output}],event:[{type:t.Output}],stateChange:[{type:t.Output}],onKeydown:[{type:t.HostListener,args:["body: keydown",["$event"]]}],onMousedown:[{type:t.HostListener,args:["body: mousedown",["$event"]]}]};var R=function(){function e(){}return e}();R.decorators=[{type:t.Component,args:[{selector:"TreeNode, tree-node",encapsulation:t.ViewEncapsulation.None,styles:[],template:'\n    <ng-container *mobxAutorun>\n      <div\n        *ngIf="!templates.treeNodeFullTemplate"\n        [class]="node.getClass()"\n        [class.tree-node]="true"\n        [class.tree-node-expanded]="node.isExpanded && node.hasChildren"\n        [class.tree-node-collapsed]="node.isCollapsed && node.hasChildren"\n        [class.tree-node-leaf]="node.isLeaf"\n        [class.tree-node-active]="node.isActive"\n        [class.tree-node-focused]="node.isFocused"\n        >\n\n        <tree-node-drop-slot *ngIf="index === 0" [dropIndex]="node.index" [node]="node.parent"></tree-node-drop-slot>\n\n        <tree-node-wrapper [node]="node" [index]="index" [templates]="templates"></tree-node-wrapper>\n\n        <tree-node-children [node]="node" [templates]="templates"></tree-node-children>\n        <tree-node-drop-slot [dropIndex]="node.index + 1" [node]="node.parent"></tree-node-drop-slot>\n      </div>\n      <ng-container\n        [ngTemplateOutlet]="templates.treeNodeFullTemplate"\n        [ngOutletContext]="{ $implicit: node, node: node, index: index, templates: templates }">\n      </ng-container>\n    </ng-container>'}]}],R.ctorParameters=function(){return[]},R.propDecorators={node:[{type:t.Input}],index:[{type:t.Input}],templates:[{type:t.Input}]};var L=function(){function e(){}return e}();L.decorators=[{type:t.Component,args:[{selector:"tree-node-content",encapsulation:t.ViewEncapsulation.None,template:'\n  <span *ngIf="!template">{{ node.displayField }}</span>\n  <ng-container\n    [ngTemplateOutlet]="template"\n    [ngOutletContext]="{ $implicit: node, node: node, index: index }">\n  </ng-container>'}]}],L.ctorParameters=function(){return[]},L.propDecorators={node:[{type:t.Input}],index:[{type:t.Input}],template:[{type:t.Input}]};var H=function(){function e(){}return e.prototype.onDrop=function(e){this.node.mouseAction("drop",e.event,{from:e.element,to:{parent:this.node,index:this.dropIndex}})},e.prototype.allowDrop=function(e,t){return this.node.options.allowDrop(e,{parent:this.node,index:this.dropIndex},t)},e}();H.decorators=[{type:t.Component,args:[{selector:"TreeNodeDropSlot, tree-node-drop-slot",encapsulation:t.ViewEncapsulation.None,styles:[],template:'\n    <div\n      class="node-drop-slot"\n      (treeDrop)="onDrop($event)"\n      [treeAllowDrop]="allowDrop.bind(this)">\n    </div>\n  '}]}],H.ctorParameters=function(){return[]},H.propDecorators={node:[{type:t.Input}],dropIndex:[{type:t.Input}]};var k=function(){function e(){}return e}();k.decorators=[{type:t.Component,args:[{selector:"TreeNodeExpander, tree-node-expander",encapsulation:t.ViewEncapsulation.None,styles:[],template:'\n    <ng-container *mobxAutorun>\n      <span\n        *ngIf="node.hasChildren"\n        [class.toggle-children-wrapper-expanded]="node.isExpanded"\n        [class.toggle-children-wrapper-collapsed]="node.isCollapsed"\n        class="toggle-children-wrapper"\n        (click)="node.mouseAction(\'expanderClick\', $event)">\n\n        <span class="toggle-children"></span>\n      </span>\n      <span\n        *ngIf="!node.hasChildren"\n        class="toggle-children-placeholder">\n  <i aria-hidden="true" class="fa fa-square" style="font-size: 9px;"></i>    </span>\n    </ng-container>\n  '}]}],k.ctorParameters=function(){return[]},k.propDecorators={node:[{type:t.Input}]};var V=function(){function e(){}return e}();V.decorators=[{type:t.Component,args:[{selector:"tree-node-children",encapsulation:t.ViewEncapsulation.None,styles:[],template:'\n    <ng-container *mobxAutorun>\n      <div [class.tree-children]="true"\n          [class.tree-children-no-padding]="node.options.levelPadding"\n          *treeAnimateOpen="\n            node.isExpanded;\n            speed:node.options.animateExpand;\n            acceleration:node.options.animateAcceleration;\n            enabled:node.options.animateExpand">\n        <tree-node-collection\n          *ngIf="node.children"\n          [nodes]="node.children"\n          [templates]="templates"\n          [treeModel]="node.treeModel">\n        </tree-node-collection>\n        <tree-loading-component\n          [style.padding-left]="node.getNodePadding()"\n          class="tree-node-loading"\n          *ngIf="!node.children"\n          [template]="templates.loadingTemplate"\n          [node]="node"\n        ></tree-loading-component>\n      </div>\n    </ng-container>\n  '}]}],V.ctorParameters=function(){return[]},V.propDecorators={node:[{type:t.Input}],templates:[{type:t.Input}]};var B=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var d=e.length-1;d>=0;d--)(r=e[d])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},$=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},G=function(){function e(){this._dispose=[]}return Object.defineProperty(e.prototype,"nodes",{get:function(){return this._nodes},set:function(e){this.setNodes(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginTop",{get:function(){var e=this.viewportNodes&&this.viewportNodes.length&&this.viewportNodes[0];return(e?e.position-e.parent.position-e.parent.getSelfHeight():0)+"px"},enumerable:!0,configurable:!0}),e.prototype.setNodes=function(e){this._nodes=e},e.prototype.ngOnInit=function(){var e=this;this.virtualScroll=this.treeModel.virtualScroll,this._dispose=[i.reaction(function(){return e.virtualScroll.getViewportNodes(e.nodes).map(function(e){return e.index})},function(t){e.viewportNodes=t.map(function(t){return e.nodes[t]})},{compareStructural:!0,fireImmediately:!0}),i.reaction(function(){return e.nodes},function(t){e.viewportNodes=e.virtualScroll.getViewportNodes(t)})]},e.prototype.ngOnDestroy=function(){this._dispose.forEach(function(e){return e()})},e.prototype.trackNode=function(e,t){return t.id},e}();G.decorators=[{type:t.Component,args:[{selector:"tree-node-collection",encapsulation:t.ViewEncapsulation.None,template:'\n    <ng-container *mobxAutorun>\n      <div\n        [style.margin-top]="marginTop">\n        <tree-node\n          *ngFor="let node of viewportNodes; let i = index; trackBy: trackNode"\n          [node]="node"\n          [index]="i"\n          [templates]="templates">\n        </tree-node>\n      </div>\n    </ng-container>\n  '}]}],G.ctorParameters=function(){return[]},G.propDecorators={nodes:[{type:t.Input}],treeModel:[{type:t.Input}],templates:[{type:t.Input}]},B([o.observable,$("design:type",Object)],G.prototype,"_nodes",void 0),B([o.observable,$("design:type",Array)],G.prototype,"viewportNodes",void 0),B([o.computed,$("design:type",String),$("design:paramtypes",[])],G.prototype,"marginTop",null),B([o.action,$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",void 0)],G.prototype,"setNodes",null);var U=function(){function e(){}return e}();U.decorators=[{type:t.Component,args:[{selector:"tree-node-wrapper",encapsulation:t.ViewEncapsulation.None,styles:[],template:'\n      <div *ngIf="!templates.treeNodeWrapperTemplate" class="node-wrapper" [style.padding-left]="node.getNodePadding()">\n        <tree-node-expander [node]="node"></tree-node-expander>\n        <div class="node-content-wrapper"\n          [class.node-content-wrapper-active]="node.isActive"\n          [class.node-content-wrapper-focused]="node.isFocused"\n          (click)="node.mouseAction(\'click\', $event)"\n          (dblclick)="node.mouseAction(\'dblClick\', $event)"\n          (contextmenu)="node.mouseAction(\'contextMenu\', $event)"\n          (treeDrop)="node.onDrop($event)"\n          (treeDropDragOver)="node.mouseAction(\'dragOver\', $event)"\n          (treeDropDragLeave)="node.mouseAction(\'dragLeave\', $event)"\n          (treeDropDragEnter)="node.mouseAction(\'dragEnter\', $event)"\n          [treeAllowDrop]="node.allowDrop"\n          [treeDrag]="node"\n          [treeDragEnabled]="node.allowDrag()">\n\n          <tree-node-content [node]="node" [index]="index" [template]="templates.treeNodeTemplate">\n          </tree-node-content>\n        </div>\n      </div>\n      <ng-container \n        [ngTemplateOutlet]="templates.treeNodeWrapperTemplate" \n        [ngOutletContext]="{ $implicit: node, node: node, index: index }">\n      </ng-container>\n    '}]}],U.ctorParameters=function(){return[]},U.propDecorators={node:[{type:t.Input}],index:[{type:t.Input}],templates:[{type:t.Input}]};var W=function(){function e(e,t){this.elementRef=e,this.virtualScroll=t}return e.prototype.ngOnInit=function(){this.virtualScroll.init()},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.setViewport(),e.virtualScroll.fireEvent({eventName:h.initialized})})},e.prototype.ngOnDestroy=function(){this.virtualScroll.clear()},e.prototype.getTotalHeight=function(){return this.virtualScroll.isEnabled()&&this.virtualScroll.totalHeight+"px"||"auto"},e.prototype.onScroll=function(){this.setViewport()},e.prototype.setViewport=function(){this.virtualScroll.setViewport(this.elementRef.nativeElement)},e}();W.decorators=[{type:t.Component,args:[{selector:"tree-viewport",styles:[],providers:[A],template:'\n    <ng-container *mobxAutorun>\n      <div [style.height]="getTotalHeight()">\n        <ng-content></ng-content>\n      </div>\n    </ng-container>\n  '}]}],W.ctorParameters=function(){return[{type:t.ElementRef},{type:A}]},W.propDecorators={onScroll:[{type:t.HostListener,args:["scroll",["$event"]]}]};var Y=function(){function e(e,n,o){this.el=e,this.renderer=n,this.treeDraggedElement=o,this.onDropCallback=new t.EventEmitter,this.onDragOverCallback=new t.EventEmitter,this.onDragLeaveCallback=new t.EventEmitter,this.onDragEnterCallback=new t.EventEmitter,this._allowDrop=function(e,t){return!0}}return Object.defineProperty(e.prototype,"treeAllowDrop",{set:function(e){e instanceof Function?this._allowDrop=e:this._allowDrop=function(t,n){return e}},enumerable:!0,configurable:!0}),e.prototype.allowDrop=function(e){return this._allowDrop(this.treeDraggedElement.get(),e)},e.prototype.onDragOver=function(e){if(!this.allowDrop(e))return this.addDisabledClass();this.onDragOverCallback.emit({event:e,element:this.treeDraggedElement.get()}),e.preventDefault(),this.addClass()},e.prototype.onDragEnter=function(e){this.allowDrop(e)&&this.onDragEnterCallback.emit({event:e,element:this.treeDraggedElement.get()})},e.prototype.onDragLeave=function(e){if(!this.allowDrop(e))return this.removeDisabledClass();this.onDragLeaveCallback.emit({event:e,element:this.treeDraggedElement.get()}),this.removeClass()},e.prototype.onDrop=function(e){this.allowDrop(e)&&(e.preventDefault(),this.onDropCallback.emit({event:e,element:this.treeDraggedElement.get()}),this.removeClass(),this.treeDraggedElement.set(null))},e.prototype.addClass=function(){this.renderer.setElementClass(this.el.nativeElement,"is-dragging-over",!0)},e.prototype.removeClass=function(){this.renderer.setElementClass(this.el.nativeElement,"is-dragging-over",!1)},e.prototype.addDisabledClass=function(){this.renderer.setElementClass(this.el.nativeElement,"is-dragging-over-disabled",!0)},e.prototype.removeDisabledClass=function(){this.renderer.setElementClass(this.el.nativeElement,"is-dragging-over-disabled",!1)},e}();Y.decorators=[{type:t.Directive,args:[{selector:"[treeDrop]"}]}],Y.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer},{type:j}]},Y.propDecorators={onDropCallback:[{type:t.Output,args:["treeDrop"]}],onDragOverCallback:[{type:t.Output,args:["treeDropDragOver"]}],onDragLeaveCallback:[{type:t.Output,args:["treeDropDragLeave"]}],onDragEnterCallback:[{type:t.Output,args:["treeDropDragEnter"]}],treeAllowDrop:[{type:t.Input}],onDragOver:[{type:t.HostListener,args:["dragover",["$event"]]}],onDragEnter:[{type:t.HostListener,args:["dragenter",["$event"]]}],onDragLeave:[{type:t.HostListener,args:["dragleave",["$event"]]}],onDrop:[{type:t.HostListener,args:["drop",["$event"]]}]};var q=function(){function e(e,t,n){this.el=e,this.renderer=t,this.treeDraggedElement=n}return e.prototype.ngDoCheck=function(){this.renderer.setElementAttribute(this.el.nativeElement,"draggable",this.treeDragEnabled?"true":"false")},e.prototype.onDragStart=function(e){e.dataTransfer.setData("text",e.target.id),this.treeDraggedElement.set(this.draggedElement),this.draggedElement.mouseAction&&this.draggedElement.mouseAction("dragStart",e)},e.prototype.onDrag=function(e){this.draggedElement.mouseAction&&this.draggedElement.mouseAction("drag",e)},e.prototype.onDragEnd=function(){this.draggedElement.mouseAction&&this.draggedElement.mouseAction("dragEnd"),this.treeDraggedElement.set(null)},e}();q.decorators=[{type:t.Directive,args:[{selector:"[treeDrag]"}]}],q.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer},{type:j}]},q.propDecorators={draggedElement:[{type:t.Input,args:["treeDrag"]}],treeDragEnabled:[{type:t.Input}],onDragStart:[{type:t.HostListener,args:["dragstart",["$event"]]}],onDrag:[{type:t.HostListener,args:["drag",["$event"]]}],onDragEnd:[{type:t.HostListener,args:["dragend"]}]};var K=function(){function e(e,t,n){this.renderer=e,this.templateRef=t,this.viewContainerRef=n}return Object.defineProperty(e.prototype,"isOpen",{set:function(e){e?(this._show(),this.isEnabled&&!1===this._isOpen&&this._animateOpen()):this.isEnabled?this._animateClose():this._hide(),this._isOpen=!!e},enumerable:!0,configurable:!0}),e.prototype._show=function(){this.innerElement||(this.innerElement=this.viewContainerRef.createEmbeddedView(this.templateRef).rootNodes[0])},e.prototype._hide=function(){this.viewContainerRef.clear(),this.innerElement=null},e.prototype._animateOpen=function(){var e=this,t=this.animateSpeed,n=this.animateAcceleration,o=0;this.renderer.setElementStyle(this.innerElement,"max-height","0"),setTimeout(function(){var r=setInterval(function(){if(!e._isOpen||!e.innerElement)return clearInterval(r);o+=t;var i=Math.round(o);e.renderer.setElementStyle(e.innerElement,"max-height",i+"px");var s=e.innerElement.getBoundingClientRect().height;t*=n,n*=1.005,s<i&&(e.renderer.setElementStyle(e.innerElement,"max-height",null),clearInterval(r))},17)})},e.prototype._animateClose=function(){var e=this;if(this.innerElement)var t=this.animateSpeed,n=this.animateAcceleration,o=this.innerElement.getBoundingClientRect().height,r=setInterval(function(){if(e._isOpen||!e.innerElement)return clearInterval(r);o-=t,e.renderer.setElementStyle(e.innerElement,"max-height",o+"px"),t*=n,n*=1.005,o<=0&&(e.viewContainerRef.clear(),e.innerElement=null,clearInterval(r))},17)},e}();K.decorators=[{type:t.Directive,args:[{selector:"[treeAnimateOpen]"}]}],K.ctorParameters=function(){return[{type:t.Renderer},{type:t.TemplateRef},{type:t.ViewContainerRef}]},K.propDecorators={animateSpeed:[{type:t.Input,args:["treeAnimateOpenSpeed"]}],animateAcceleration:[{type:t.Input,args:["treeAnimateOpenAcceleration"]}],isEnabled:[{type:t.Input,args:["treeAnimateOpenEnabled"]}],isOpen:[{type:t.Input,args:["treeAnimateOpen"]}]},"undefined"!=typeof Element&&("function"!=typeof Element.prototype.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=this,n=(t.document||t.ownerDocument).querySelectorAll(e),o=0;n[o]&&n[o]!==t;)++o;return Boolean(n[o])}),"function"!=typeof Element.prototype.closest&&(Element.prototype.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null}));var z=function(){function e(){}return e}();z.decorators=[{type:t.NgModule,args:[{declarations:[S,R,L,M,Y,q,k,V,H,G,W,U,K],exports:[S,R,L,M,Y,q,k,V,H,G,W,U,K],imports:[n.CommonModule,o.MobxAngularModule],providers:[j]}]}],z.ctorParameters=function(){return[]},e.TreeModule=z,e.TreeModel=w,e.TreeNode=m,e.TreeDraggedElement=j,e.TreeVirtualScroll=A,e.TREE_ACTIONS=l,e.KEYS=a,e.LoadingComponent=M,e.TreeComponent=S,e.TreeNodeComponent=R,e.TreeNodeContent=L,e.TreeDropDirective=Y,e.TreeDragDirective=q,e.TreeNodeExpanderComponent=k,e.TreeNodeChildrenComponent=V,e.TreeNodeDropSlot=H,e.TreeNodeCollectionComponent=G,e.TreeViewportComponent=W,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular-tree-component.umd.js.map
